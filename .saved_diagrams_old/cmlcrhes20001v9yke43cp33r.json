{
  "id": "cmlcrhes20001v9yke43cp33r",
  "userId": "guest_1770075292779_tnxmitmc339",
  "title": "restaurant management platform",
  "description": "A cloud-native, real-time restaurant management platform integrating Point of Sale (POS), Kitchen Display Systems (KDS), and inventory analytics to streamline front and back-of-house operations.",
  "status": "completed",
  "metadata": {
    "prompt": "restaurant management platform",
    "options": {
      "includeStateManagement": true,
      "includeAPIs": true,
      "includeDatabase": true,
      "model": "gemini-3-pro-preview",
      "reasoning": false
    },
    "metasop_artifacts": {
      "pm_spec": {
        "step_id": "pm_spec",
        "role": "Product Manager",
        "content": {
          "summary": "A cloud-native, real-time restaurant management platform integrating Point of Sale (POS), Kitchen Display Systems (KDS), and inventory analytics to streamline front and back-of-house operations.",
          "description": "This platform addresses the chaotic nature of restaurant operations by synchronizing data instantly between servers, the kitchen, and management. Targeted at mid-sized full-service restaurants, it replaces legacy paper-ticket systems with digital workflows. The core value proposition is increasing table turnover rates, reducing food waste through precise ordering, and providing owners with actionable real-time sales data.",
          "user_stories": [
            {
              "title": "Digital Order Entry",
              "story": "As a Server, I want to input customer orders on a handheld device so that the kitchen receives them instantly without manual tickets.",
              "description": "Develop a responsive POS interface for tablets allowing item selection, modifier customization (e.g., no onions), and order submission to the backend.",
              "priority": "critical",
              "story_points": 5,
              "acceptance_criteria": [
                "Server can select items from categorized menu",
                "Modifiers can be added to specific items",
                "Order submission triggers real-time update to backend",
                "UI provides visual confirmation of successful submission",
                "Offline mode stores order locally until reconnected"
              ],
              "estimated_complexity": "medium",
              "user_value": "Reduces order errors and speeds up service time by 30%",
              "dependencies": [],
              "id": "US-1"
            },
            {
              "title": "Kitchen Display System (KDS)",
              "story": "As a Line Cook, I want to see incoming orders sorted by time and station so that I can prepare food in the correct sequence.",
              "description": "Create a real-time dashboard for kitchen screens that displays active orders, highlights long-wait items, and allows bumping orders when complete.",
              "priority": "critical",
              "story_points": 8,
              "acceptance_criteria": [
                "Orders appear on KDS within 2 seconds of submission",
                "Items are routed to specific stations (Grill vs Salad)",
                "Color coding changes based on wait time thresholds",
                "Cook can mark individual items or whole tickets as done",
                "Recall function exists for accidentally closed tickets"
              ],
              "estimated_complexity": "large",
              "user_value": "Eliminates lost paper tickets and optimizes kitchen throughput",
              "dependencies": [
                "US-1"
              ],
              "id": "US-2"
            },
            {
              "title": "Dynamic Table Management",
              "story": "As a Host, I want to see a visual map of table occupancy status so that I can seat walk-in guests efficiently.",
              "description": "Implement a drag-and-drop floor plan editor and a live view showing table status (Open, Seated, Billed, Dirty).",
              "priority": "high",
              "story_points": 5,
              "acceptance_criteria": [
                "Map reflects real-time status changes from POS",
                "Host can manually update table status",
                "Hovering over a table shows current server and seating time",
                "Layout supports multiple rooms/zones",
                "Conflict alert if assigning a seated table"
              ],
              "estimated_complexity": "medium",
              "user_value": "Maximizes seating capacity and reduces customer wait times",
              "dependencies": [],
              "id": "US-3"
            },
            {
              "title": "Menu Configuration",
              "story": "As a Manager, I want to edit menu items, modifiers, and prices in real-time so that servers always have up-to-date information.",
              "description": "Build an admin panel for CRUD operations on menu categories, items, and pricing, including 86ing (out of stock) items.",
              "priority": "high",
              "story_points": 3,
              "acceptance_criteria": [
                "Manager can add/edit/delete menu items",
                "Price changes reflect immediately on POS terminals",
                "Items can be marked as 'Out of Stock' globally",
                "Supports time-based menus (Breakfast/Lunch/Dinner)",
                "Audit log tracks who made changes and when"
              ],
              "estimated_complexity": "small",
              "user_value": "Ensures pricing accuracy and inventory availability",
              "dependencies": [],
              "id": "US-4"
            },
            {
              "title": "Bill Splitting",
              "story": "As a Server, I want to split a check by seat or specific items so that customers can pay separately.",
              "description": "Implement logic to divide a single order object into multiple sub-orders or payment transactions without data loss.",
              "priority": "medium",
              "story_points": 5,
              "acceptance_criteria": [
                "Split by equal amounts (e.g., 1/3 each)",
                "Split by specific items assigned to seats",
                "Combined payment methods allowed (Cash + Card)",
                "Original total matches sum of splits exactly",
                "Receipts print individually for each split"
              ],
              "estimated_complexity": "medium",
              "user_value": "Improves customer satisfaction during payment process",
              "dependencies": [
                "US-1"
              ],
              "id": "US-5"
            }
          ],
          "acceptance_criteria": [
            {
              "criteria": "System must handle 500 concurrent connections without latency exceeding 200ms.",
              "priority": "must",
              "description": "Performance requirement for peak hours.",
              "id": "AC-1",
              "title": "High Load Performance"
            },
            {
              "criteria": "All payment data must be encrypted and PCI-DSS compliant.",
              "priority": "must",
              "description": "Security compliance requirement.",
              "id": "AC-2",
              "title": "Security Compliance"
            },
            {
              "criteria": "UI must be fully functional on 10-inch tablets in landscape mode.",
              "priority": "should",
              "description": "Device compatibility standard.",
              "id": "AC-3",
              "title": "Tablet Responsiveness"
            },
            {
              "criteria": "System should support dark mode for low-light restaurant environments.",
              "priority": "could",
              "description": "Accessibility and UX enhancement.",
              "id": "AC-4",
              "title": "Dark Mode Support"
            }
          ],
          "ui_multi_section": true,
          "assumptions": [
            "Venue has reliable high-speed internet connection.",
            "Staff will use provided tablets (iPad or Android) for POS.",
            "Payment processing is handled via third-party API (Stripe/Square).",
            "Kitchen hardware supports HTML5 browser rendering."
          ],
          "out_of_scope": [
            "Delivery driver fleet tracking.",
            "Customer-facing mobile ordering app (Phase 2).",
            "Native payroll processing (integration only).",
            "Hardware procurement and installation services."
          ],
          "swot": {
            "strengths": [
              "Real-time WebSocket synchronization",
              "Hardware agnostic (runs on any browser)",
              "Intuitive UX requiring minimal training",
              "Lower cost than legacy hardware systems"
            ],
            "weaknesses": [
              "Dependency on internet connectivity",
              "Brand new market entrant vs established players",
              "Limited offline functionality in MVP",
              "No native hardware support"
            ],
            "opportunities": [
              "AI-driven inventory forecasting",
              "Self-service kiosk mode integration",
              "Partnerships with local food suppliers",
              "White-labeling for franchise chains"
            ],
            "threats": [
              "Aggressive pricing from Toast and Square",
              "Internet outages at client locations",
              "High cost of customer acquisition",
              "Data privacy regulation changes"
            ]
          },
          "stakeholders": [
            {
              "role": "Restaurant Owner",
              "interest": "ROI, theft prevention, and sales reporting",
              "influence": "high"
            },
            {
              "role": "Waitstaff",
              "interest": "Ease of use, speed of order entry, tip tracking",
              "influence": "medium"
            },
            {
              "role": "Head Chef",
              "interest": "Order clarity, timing accuracy, kitchen flow",
              "influence": "medium"
            },
            {
              "role": "Investors",
              "interest": "Market adoption and scalability",
              "influence": "high"
            }
          ],
          "invest_analysis": [
            {
              "user_story_id": "US-1",
              "independent": true,
              "negotiable": true,
              "valuable": true,
              "estimatable": true,
              "small": true,
              "testable": true,
              "score": 10,
              "comments": "Core feature, highly independent."
            },
            {
              "user_story_id": "US-2",
              "independent": false,
              "negotiable": true,
              "valuable": true,
              "estimatable": true,
              "small": false,
              "testable": true,
              "score": 7,
              "comments": "Depends on US-1; complex logic."
            },
            {
              "user_story_id": "US-3",
              "independent": true,
              "negotiable": true,
              "valuable": true,
              "estimatable": true,
              "small": true,
              "testable": true,
              "score": 9,
              "comments": "Can be built in parallel with POS."
            },
            {
              "user_story_id": "US-4",
              "independent": true,
              "negotiable": true,
              "valuable": true,
              "estimatable": true,
              "small": true,
              "testable": true,
              "score": 10,
              "comments": "Standard CRUD, low risk."
            },
            {
              "user_story_id": "US-5",
              "independent": false,
              "negotiable": true,
              "valuable": true,
              "estimatable": true,
              "small": true,
              "testable": true,
              "score": 8,
              "comments": "Complex math, depends on US-1."
            }
          ]
        },
        "timestamp": "2026-02-07T20:23:57.128Z"
      },
      "arch_design": {
        "step_id": "arch_design",
        "role": "Architect",
        "content": {
          "design_doc": "## System Architecture Overview\n\nThe Restaurant Management Platform is designed as a cloud-native, event-driven system to ensure sub-second synchronization between Point of Sale (POS) terminals and Kitchen Display Systems (KDS). The architecture prioritizes high availability, offline tolerance, and data consistency.\n\n### Core Components\n\n1.  **Client Layer**: \n    - **POS Tablet App**: A React Native application optimized for 10-inch tablets. It utilizes a local SQLite database (WatermelonDB) to store menu data and active orders, enabling full offline functionality. Synchronization occurs via a background sync engine when connectivity is restored.\n    - **KDS Web App**: A React-based Single Page Application (SPA) running on kitchen hardware. It relies on persistent WebSocket connections to receive real-time order tickets.\n    - **Manager Portal**: A web dashboard for menu configuration, floor plan editing, and analytics.\n\n2.  **API Gateway & Load Balancer**: \n    - Nginx acts as the entry point, handling SSL termination, rate limiting, and routing traffic to the backend services.\n\n3.  **Backend Services (Modular Monolith)**:\n    - Built with Node.js (NestJS), the backend is structured into domain modules (Orders, Inventory, Staff, Payments). \n    - **Real-time Engine**: A dedicated WebSocket service (Socket.io adapter backed by Redis) handles the broadcasting of events (e.g., `ORDER_CREATED`, `ITEM_BUMPED`) to connected KDS clients.\n\n4.  **Data Layer**:\n    - **Primary Database**: PostgreSQL serves as the source of truth for all transactional data. It uses a multi-tenant schema design (row-level security via `restaurant_id`).\n    - **Cache**: Redis is used for session management and caching frequently accessed menu data to reduce database load.\n\n### Data Flow\n\n1.  **Order Creation**: Server inputs order on POS -> Local DB save -> API POST (background sync) -> Backend validates -> DB Insert -> Event Published to Redis.\n2.  **Kitchen Notification**: Redis Subscriber -> WebSocket Service -> Broadcast to specific Restaurant Room -> KDS renders ticket.\n3.  **Completion**: Cook bumps order on KDS -> API PATCH -> DB Update -> WebSocket notifies POS (server alerted).\n\n### Offline Strategy\n\nTo satisfy the critical requirement of continuous operation, the POS generates UUIDv7 primary keys locally. This allows complex relational data (Orders -> OrderItems -> Modifiers) to be created without waiting for a server response. Conflict resolution uses a 'last-write-wins' strategy for status updates, while append-only logs are used for financial transactions.",
          "apis": [
            {
              "path": "/api/v1/orders",
              "method": "POST",
              "description": "Submit a new order from POS.",
              "request_schema": {
                "tableId": "string",
                "items": "array",
                "serverNotes": "string"
              },
              "response_schema": {
                "id": "string",
                "status": "string",
                "createdAt": "string"
              },
              "auth_required": true,
              "rate_limit": "60 req/min"
            },
            {
              "path": "/api/v1/orders",
              "method": "GET",
              "description": "Retrieve active orders for KDS.",
              "request_schema": {
                "status": "string",
                "limit": "number",
                "cursor": "string"
              },
              "response_schema": {
                "data": "array",
                "nextCursor": "string"
              },
              "auth_required": true,
              "rate_limit": "100 req/min"
            },
            {
              "path": "/api/v1/orders/{id}/status",
              "method": "PATCH",
              "description": "Update order status (e.g., cooking, ready).",
              "request_schema": {
                "status": "string",
                "bumpedBy": "string"
              },
              "response_schema": {
                "id": "string",
                "status": "string",
                "updatedAt": "string"
              },
              "auth_required": true,
              "rate_limit": "100 req/min"
            },
            {
              "path": "/api/v1/tables",
              "method": "GET",
              "description": "Get current floor plan status.",
              "request_schema": {},
              "response_schema": {
                "tables": "array"
              },
              "auth_required": true,
              "rate_limit": "60 req/min"
            },
            {
              "path": "/api/v1/payments/split",
              "method": "POST",
              "description": "Split a bill into multiple sub-payments.",
              "request_schema": {
                "orderId": "string",
                "splits": "array"
              },
              "response_schema": {
                "transactionIds": "array",
                "remainingBalance": "number"
              },
              "auth_required": true,
              "rate_limit": "20 req/min"
            }
          ],
          "summary": "A high-performance, event-driven platform utilizing React Native for offline-first POS operations and WebSockets for real-time Kitchen Display System synchronization, backed by a scalable PostgreSQL/Node.js architecture.",
          "description": "The system replaces legacy restaurant workflows with a cloud-native solution. It features a distributed architecture where POS tablets operate with local databases (WatermelonDB) to ensure service continuity during internet outages, synchronizing with the central backend via UUIDv7 keys. The backend leverages Redis Pub/Sub to instantly route orders to specific kitchen stations, ensuring the 'High Load Performance' acceptance criteria is met.",
          "decisions": [
            {
              "decision": "Use PostgreSQL as primary database",
              "status": "accepted",
              "reason": "ACID compliance is non-negotiable for financial transactions and inventory management. Relational model fits the structured nature of Menus, Orders, and Tables perfectly.",
              "tradeoffs": "Schema migrations can be painful compared to NoSQL; scaling writes requires vertical scaling or sharding.",
              "consequences": "Must implement strict migration pipelines; use JSONB columns for flexible menu modifiers.",
              "alternatives": [
                "MongoDB (rejected: lack of multi-document transactions in older versions, eventual consistency risks)",
                "Firebase (rejected: querying capabilities too limited for complex reporting)"
              ]
            },
            {
              "decision": "Implement UUIDv7 for Primary Keys",
              "status": "accepted",
              "reason": "Allows offline generation of IDs on the client side (POS) that are time-sortable, preventing collision during sync and maintaining index locality.",
              "tradeoffs": "Slightly larger storage footprint than integers; slightly slower insert performance than sequential integers.",
              "consequences": "Frontend must include UUID generation library; DB schema must use UUID type.",
              "alternatives": [
                "Auto-increment Integers (rejected: impossible to generate offline without collision)",
                "UUIDv4 (rejected: poor database index performance due to randomness)"
              ]
            },
            {
              "decision": "Use WebSockets (Socket.io) for KDS Sync",
              "status": "accepted",
              "reason": "Polling introduces latency unacceptable for a high-paced kitchen environment. WebSockets provide sub-200ms updates required by AC-1.",
              "tradeoffs": "Requires maintaining stateful connections; scaling requires Redis adapter for pub/sub across nodes.",
              "consequences": "Need to configure sticky sessions in load balancer or use a stateless transport fallback.",
              "alternatives": [
                "Short Polling (rejected: high server load, latency)",
                "Server-Sent Events (considered: good for one-way, but we need bi-directional for bumping)"
              ]
            },
            {
              "decision": "Logical Multi-Tenancy (Row-Level Security)",
              "status": "accepted",
              "reason": "Cost-effective for mid-sized market. Physical isolation (one DB per client) is operationally complex and expensive to maintain for thousands of small restaurants.",
              "tradeoffs": "Risk of data leak if `restaurant_id` filter is missed in queries; noisy neighbor problem.",
              "consequences": "Must implement rigorous testing of tenant isolation; use RLS policies in Postgres as a safety net.",
              "alternatives": [
                "Database-per-tenant (rejected: too expensive for target market)",
                "Schema-per-tenant (rejected: migration complexity)"
              ]
            }
          ],
          "database_schema": {
            "tables": [
              {
                "name": "restaurants",
                "columns": [
                  {
                    "name": "id",
                    "type": "UUID",
                    "constraints": [
                      "PRIMARY KEY"
                    ],
                    "description": "Tenant ID"
                  },
                  {
                    "name": "name",
                    "type": "VARCHAR(100)",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Restaurant Name"
                  },
                  {
                    "name": "settings",
                    "type": "JSONB",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Config like tax rates, timezone"
                  }
                ],
                "description": "Tenant configuration",
                "indexes": [
                  {
                    "columns": [
                      "id"
                    ],
                    "type": "btree"
                  }
                ],
                "relationships": []
              },
              {
                "name": "orders",
                "columns": [
                  {
                    "name": "id",
                    "type": "UUID",
                    "constraints": [
                      "PRIMARY KEY"
                    ],
                    "description": "UUIDv7"
                  },
                  {
                    "name": "restaurant_id",
                    "type": "UUID",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Tenant FK"
                  },
                  {
                    "name": "table_id",
                    "type": "UUID",
                    "constraints": [
                      "NULLABLE"
                    ],
                    "description": "Table FK"
                  },
                  {
                    "name": "status",
                    "type": "VARCHAR(20)",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "OPEN, SENT, BILLED, CLOSED"
                  },
                  {
                    "name": "total_amount",
                    "type": "DECIMAL(10,2)",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Final cost"
                  }
                ],
                "description": "Head of the order ticket",
                "indexes": [
                  {
                    "columns": [
                      "restaurant_id",
                      "status"
                    ],
                    "type": "btree"
                  }
                ],
                "relationships": [
                  {
                    "type": "many-to-one",
                    "from": "restaurant_id",
                    "to": "restaurants.id"
                  },
                  {
                    "type": "many-to-one",
                    "from": "table_id",
                    "to": "tables.id"
                  }
                ]
              },
              {
                "name": "order_items",
                "columns": [
                  {
                    "name": "id",
                    "type": "UUID",
                    "constraints": [
                      "PRIMARY KEY"
                    ],
                    "description": "UUIDv7"
                  },
                  {
                    "name": "order_id",
                    "type": "UUID",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Parent Order FK"
                  },
                  {
                    "name": "menu_item_id",
                    "type": "UUID",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Item FK"
                  },
                  {
                    "name": "modifiers",
                    "type": "JSONB",
                    "constraints": [
                      "DEFAULT '{}'"
                    ],
                    "description": "Customizations (No onions)"
                  },
                  {
                    "name": "status",
                    "type": "VARCHAR(20)",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "PENDING, COOKING, READY"
                  }
                ],
                "description": "Individual line items",
                "indexes": [
                  {
                    "columns": [
                      "order_id"
                    ],
                    "type": "btree"
                  }
                ],
                "relationships": [
                  {
                    "type": "many-to-one",
                    "from": "order_id",
                    "to": "orders.id"
                  }
                ]
              },
              {
                "name": "tables",
                "columns": [
                  {
                    "name": "id",
                    "type": "UUID",
                    "constraints": [
                      "PRIMARY KEY"
                    ],
                    "description": "UUIDv7"
                  },
                  {
                    "name": "restaurant_id",
                    "type": "UUID",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "Tenant FK"
                  },
                  {
                    "name": "status",
                    "type": "VARCHAR(20)",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "OPEN, SEATED, DIRTY"
                  },
                  {
                    "name": "coordinates",
                    "type": "JSONB",
                    "constraints": [
                      "NOT NULL"
                    ],
                    "description": "x, y, rotation"
                  }
                ],
                "description": "Physical layout configuration",
                "indexes": [
                  {
                    "columns": [
                      "restaurant_id"
                    ],
                    "type": "btree"
                  }
                ],
                "relationships": [
                  {
                    "type": "many-to-one",
                    "from": "restaurant_id",
                    "to": "restaurants.id"
                  }
                ]
              }
            ]
          },
          "technology_stack": {
            "frontend": [
              "React Native (Tablets)",
              "React (KDS/Admin)",
              "TailwindCSS",
              "WatermelonDB (Offline)"
            ],
            "backend": [
              "Node.js",
              "NestJS",
              "Socket.io",
              "TypeScript"
            ],
            "database": [
              "PostgreSQL 15",
              "Redis (Pub/Sub & Cache)"
            ],
            "authentication": [
              "Auth0",
              "JWT"
            ],
            "hosting": [
              "AWS ECS (Fargate)",
              "AWS RDS",
              "AWS ElastiCache"
            ],
            "other": [
              "Stripe API",
              "Docker",
              "Terraform"
            ]
          },
          "security_considerations": [
            "PCI-DSS compliance via Stripe Elements (no raw card data touches server)",
            "Row-Level Security (RLS) in PostgreSQL to enforce tenant isolation",
            "WAF (Web Application Firewall) to prevent DDoS on WebSocket endpoints",
            "Short-lived JWTs for POS terminals with refresh token rotation"
          ],
          "scalability_approach": {
            "caching_strategy": "Redis for session storage and high-read menu data. CDN for static assets (images).",
            "database_scaling": "Read replicas for analytics/reporting queries. Connection pooling via PgBouncer.",
            "horizontal_scaling": "Stateless backend services scaled via AWS Auto Scaling Groups based on CPU/Memory.",
            "performance_targets": "API latency < 100ms, WebSocket broadcast < 200ms, 99.9% uptime."
          },
          "integration_points": [
            {
              "service": "Stripe Connect",
              "purpose": "Payment processing and split checks",
              "api_docs": "https://stripe.com/docs/api"
            },
            {
              "service": "SendGrid",
              "purpose": "Emailing digital receipts to customers",
              "api_docs": "https://docs.sendgrid.com/api-reference"
            },
            {
              "service": "Auth0",
              "purpose": "Identity management for staff and owners",
              "api_docs": "https://auth0.com/docs/api"
            }
          ]
        },
        "timestamp": "2026-02-07T20:24:46.921Z"
      },
      "security_architecture": {
        "step_id": "security_architecture",
        "role": "Security",
        "content": {
          "summary": "A Zero-Trust architecture enforcing strict multi-tenant isolation via PostgreSQL Row-Level Security and securing offline-first data synchronization with cryptographic validation. The system leverages AWS managed security services (WAF, KMS, Cognito/Auth0) to mitigate threats across the hybrid cloud/edge environment.",
          "description": "The security architecture is designed to protect a distributed, offline-capable restaurant platform. The primary attack surface involves the synchronization of data between untrusted POS tablets and the cloud backend. To mitigate tampering, the system employs server-side validation of all synced UUIDv7 records. Multi-tenancy is secured not just at the application layer, but enforced at the database level using PostgreSQL Row-Level Security (RLS) to prevent cross-tenant data leaks. Real-time WebSockets are protected via rate limiting and strict JWT authentication to prevent DoS. All sensitive data is encrypted at rest using envelope encryption via AWS KMS, and payments are offloaded to Stripe to minimize PCI-DSS scope.",
          "security_architecture": {
            "authentication": {
              "method": "JWT",
              "providers": [
                "Auth0",
                "Google",
                "Email/Password"
              ],
              "mfa_enabled": true
            },
            "authorization": {
              "model": "RBAC",
              "roles": [
                "owner",
                "manager",
                "server",
                "cook"
              ],
              "policies": [
                {
                  "resource": "orders",
                  "permissions": [
                    "create",
                    "read",
                    "update"
                  ],
                  "roles": [
                    "server",
                    "manager"
                  ]
                },
                {
                  "resource": "menu_config",
                  "permissions": [
                    "create",
                    "update",
                    "delete"
                  ],
                  "roles": [
                    "manager",
                    "owner"
                  ]
                },
                {
                  "resource": "financial_reports",
                  "permissions": [
                    "read"
                  ],
                  "roles": [
                    "owner"
                  ]
                }
              ]
            },
            "session_management": {
              "http_only_cookies": true,
              "same_site_policy": "Strict",
              "secure_cookies": true,
              "session_timeout": "12h",
              "strategy": "stateless"
            },
            "audit_logging": {
              "enabled": true,
              "events": [
                "login_success",
                "login_failed",
                "order_voided",
                "menu_price_change",
                "payment_refund"
              ],
              "retention": "1y",
              "storage_location": "AWS S3 (Immutable Object Lock)"
            }
          },
          "threat_model": [
            {
              "threat": "Cross-Tenant Data Leak via RLS Bypass",
              "mitigation": "Enforce Row-Level Security (RLS) on all tables with extensive unit tests for tenant isolation policies.",
              "severity": "critical",
              "affected_components": [
                "PostgreSQL",
                "API Layer"
              ],
              "category": "Information Disclosure",
              "cwe_ref": "CWE-200",
              "description": "An attacker exploits a flaw in the query logic to access data belonging to another restaurant tenant.",
              "impact": "Massive data breach, loss of customer trust, legal penalties.",
              "likelihood": "medium",
              "owasp_ref": "A01:2021 - Broken Access Control"
            },
            {
              "threat": "WebSocket Connection Exhaustion (DoS)",
              "mitigation": "Implement strict rate limiting per IP/Tenant and enforce max concurrent connection limits in Nginx and Socket.io.",
              "severity": "high",
              "affected_components": [
                "Socket.io Service",
                "Load Balancer"
              ],
              "category": "Denial of Service",
              "cwe_ref": "CWE-400",
              "description": "Malicious actor floods the WebSocket server with connection requests, preventing KDS updates.",
              "impact": "Kitchen operations halt, inability to process orders.",
              "likelihood": "medium",
              "owasp_ref": "A05:2021 - Security Misconfiguration"
            },
            {
              "threat": "Offline Transaction Tampering",
              "mitigation": "Implement cryptographic checksums for offline order batches and server-side validation of all synced data.",
              "severity": "high",
              "affected_components": [
                "POS Tablet",
                "Sync Engine"
              ],
              "category": "Tampering",
              "cwe_ref": "CWE-353",
              "description": "Attacker modifies local SQLite data on the tablet before connectivity is restored to alter prices or totals.",
              "impact": "Financial loss, inventory discrepancies.",
              "likelihood": "medium",
              "owasp_ref": "A08:2021 - Software and Data Integrity Failures"
            },
            {
              "threat": "Privilege Escalation via API Parameter Manipulation",
              "mitigation": "Strict DTO validation using Zod and backend role checks for every API endpoint, ignoring client-sent role params.",
              "severity": "critical",
              "affected_components": [
                "API Layer",
                "NestJS Guards"
              ],
              "category": "Elevation of Privilege",
              "cwe_ref": "CWE-269",
              "description": "A server modifies API requests to perform manager-level actions like voiding items or changing prices.",
              "impact": "Unauthorized financial changes, theft facilitation.",
              "likelihood": "medium",
              "owasp_ref": "A01:2021 - Broken Access Control"
            }
          ],
          "encryption": {
            "data_at_rest": {
              "method": "AES-256-GCM",
              "key_management": "AWS KMS (Key Management Service)",
              "description": "Full disk encryption for RDS and ElastiCache; field-level encryption for PII."
            },
            "data_in_transit": {
              "method": "TLS 1.3",
              "certificate_management": "AWS Certificate Manager (ACM) with auto-renewal",
              "description": "Enforced HTTPS for all API and WebSocket traffic; HSTS enabled."
            },
            "key_management": {
              "strategy": "Centralized Key Management via AWS KMS",
              "description": "Customer Master Keys (CMKs) managed in KMS with strict IAM usage policies.",
              "rotation_policy": "Automatic annual rotation"
            },
            "envelope_encryption": true,
            "secrets_management": "AWS Secrets Manager"
          },
          "security_controls": [
            {
              "control": "Web Application Firewall (WAF)",
              "implementation": "AWS WAF rules configured for SQLi, XSS, and rate limiting on API Gateway.",
              "category": "preventive",
              "description": "Filters malicious web traffic before it reaches the application.",
              "id": "SC-01",
              "priority": "critical",
              "type": "Network Security"
            },
            {
              "control": "Row-Level Security (RLS)",
              "implementation": "PostgreSQL policies enforcing 'restaurant_id' checks on every query.",
              "category": "preventive",
              "description": "Database-level isolation to prevent cross-tenant data leakage.",
              "id": "SC-02",
              "priority": "critical",
              "type": "Data Security"
            },
            {
              "control": "Automated Vulnerability Scanning",
              "implementation": "GitHub Dependabot for deps and AWS Inspector for container/EC2 scanning.",
              "category": "detective",
              "description": "Continuous monitoring of dependencies and infrastructure for CVEs.",
              "id": "SC-03",
              "priority": "high",
              "type": "Vulnerability Mgmt"
            },
            {
              "control": "Centralized Audit Logging",
              "implementation": "NestJS interceptors sending structured logs to CloudWatch/S3.",
              "category": "detective",
              "description": "Immutable record of all critical system actions for forensics.",
              "id": "SC-04",
              "priority": "high",
              "type": "Logging"
            }
          ],
          "compliance": [
            {
              "standard": "PCI-DSS",
              "requirements": [
                "Requirement 3: Protect stored cardholder data",
                "Requirement 4: Encrypt transmission of cardholder data"
              ],
              "implementation_status": "compliant",
              "description": "Utilizing Stripe Elements (SAQ-A) to ensure no raw card data touches our servers."
            },
            {
              "standard": "GDPR",
              "requirements": [
                "Article 32: Security of processing",
                "Article 17: Right to erasure"
              ],
              "implementation_status": "in-progress",
              "description": "Implementing automated data purging workflows and consent management for staff data."
            },
            {
              "standard": "SOC2",
              "requirements": [
                "CC6.1: Logical Access Security",
                "CC6.7: Transmission Security"
              ],
              "implementation_status": "planned",
              "description": "Establishing baseline controls for future audit readiness."
            }
          ],
          "vulnerability_management": {
            "remediation_sla": "Critical: 24h, High: 7d, Medium: 30d",
            "scanning_frequency": "Continuous (CI/CD) + Weekly Deep Scans",
            "tools": [
              "AWS Inspector",
              "Snyk",
              "OWASP ZAP",
              "Dependabot"
            ]
          },
          "security_monitoring": {
            "alerting_thresholds": "5 failed logins/min, >100 orders/min per tenant, >1% 5xx error rate",
            "logging_strategy": "Structured JSON logging with correlation IDs across microservices; centralized in CloudWatch.",
            "siem_solution": "AWS Security Hub / CloudWatch Logs Insights"
          }
        },
        "timestamp": "2026-02-07T20:25:27.858Z"
      },
      "devops_infrastructure": {
        "step_id": "devops_infrastructure",
        "role": "DevOps",
        "content": {
          "summary": "A high-availability AWS infrastructure using EKS for container orchestration and RDS PostgreSQL, managed via Terraform to ensure sub-100ms latency and 99.9% uptime.",
          "description": "The infrastructure leverages AWS EKS to orchestrate the modular monolith, ensuring scalability for both the REST API and the WebSocket gateway. We utilize a Blue-Green deployment strategy via ArgoCD to minimize risk during updates. Data persistence is handled by Multi-AZ RDS PostgreSQL with strict security groups and IAM authentication. Redis ElastiCache is configured in Cluster Mode to handle high-throughput Pub/Sub events for the KDS. Observability is centralized in Datadog, monitoring business-critical metrics like 'Order-to-Kitchen' latency.",
          "infrastructure": {
            "cloud_provider": "AWS",
            "services": [
              {
                "name": "eks-cluster",
                "type": "compute",
                "configuration": {
                  "version": "1.27",
                  "node_group": "managed",
                  "instance_types": "t3.medium, m5.large"
                },
                "description": "EKS cluster for container orchestration."
              },
              {
                "name": "primary-db",
                "type": "database",
                "configuration": {
                  "engine": "postgres",
                  "version": "15.4",
                  "instance_class": "db.r6g.large",
                  "storage": "gp3"
                },
                "description": "Multi-AZ RDS PostgreSQL for transactional data."
              },
              {
                "name": "redis-cache",
                "type": "storage",
                "configuration": {
                  "engine": "redis",
                  "cluster_mode": "enabled",
                  "node_type": "cache.t4g.medium"
                },
                "description": "ElastiCache for Pub/Sub and session management."
              },
              {
                "name": "alb-ingress",
                "type": "load-balancer",
                "configuration": {
                  "scheme": "internet-facing",
                  "target_type": "ip",
                  "stickiness": "enabled"
                },
                "description": "Application Load Balancer with WebSocket support."
              }
            ],
            "regions": [
              "us-east-1",
              "us-west-2"
            ],
            "iac": "Terraform"
          },
          "cicd": {
            "pipeline_stages": [
              {
                "name": "Build & Test",
                "steps": [
                  "Checkout",
                  "Install Deps",
                  "Lint",
                  "Unit Tests",
                  "Build Docker Image"
                ],
                "goal": "Ensure code quality and create artifacts.",
                "status": "active"
              },
              {
                "name": "Security Scan",
                "steps": [
                  "Container Scan (Trivy)",
                  "SAST (SonarQube)",
                  "Dependency Audit"
                ],
                "goal": "Detect vulnerabilities before deployment.",
                "status": "active"
              },
              {
                "name": "Deploy Staging",
                "steps": [
                  "Terraform Plan",
                  "Terraform Apply",
                  "Helm Upgrade"
                ],
                "goal": "Deploy to pre-prod environment.",
                "status": "active"
              },
              {
                "name": "E2E Verification",
                "steps": [
                  "Run Cypress Tests",
                  "Load Test (k6)"
                ],
                "goal": "Validate functionality under load.",
                "status": "active"
              },
              {
                "name": "Deploy Prod",
                "steps": [
                  "Manual Approval",
                  "Canary Rollout",
                  "Health Check"
                ],
                "goal": "Release to production users.",
                "status": "active"
              }
            ],
            "tools": [
              "GitHub Actions",
              "ArgoCD",
              "SonarQube"
            ],
            "triggers": [
              {
                "type": "push",
                "branch": "main",
                "description": "Triggers build and staging deploy."
              },
              {
                "type": "pull_request",
                "branch": "*",
                "description": "Triggers tests and linting."
              }
            ]
          },
          "containerization": {
            "docker_compose": "version: '3.8', services: { api: { build: '.', ports: ['3000:3000'] }, db: { image: 'postgres:15' } }",
            "dockerfile": "FROM node:18-alpine AS builder\nWORKDIR /app\nCOPY . .\nRUN npm ci && npm run build\nFROM node:18-alpine\nCOPY --from=builder /app/dist ./dist\nCMD [\"node\", \"dist/main\"]",
            "kubernetes": {
              "deployments": [
                {
                  "name": "backend-api",
                  "replicas": 3,
                  "resources": {
                    "cpu": "500m",
                    "memory": "512Mi"
                  }
                },
                {
                  "name": "websocket-gateway",
                  "replicas": 5,
                  "resources": {
                    "cpu": "1",
                    "memory": "1Gi"
                  }
                }
              ],
              "namespace": "restaurant-platform",
              "services": [
                {
                  "name": "api-service",
                  "ports": [
                    {
                      "port": 80,
                      "targetPort": 3000
                    }
                  ],
                  "type": "ClusterIP"
                },
                {
                  "name": "ws-service",
                  "ports": [
                    {
                      "port": 80,
                      "targetPort": 8080
                    }
                  ],
                  "type": "LoadBalancer"
                }
              ]
            }
          },
          "monitoring": {
            "tools": [
              "Datadog",
              "CloudWatch",
              "PagerDuty"
            ],
            "metrics": [
              {
                "name": "API Latency",
                "threshold": "100ms",
                "action": "Scale Out / Alert Warning"
              },
              {
                "name": "WebSocket Broadcast Lag",
                "threshold": "200ms",
                "action": "Alert Critical"
              },
              {
                "name": "Error Rate",
                "threshold": "1%",
                "action": "Trigger Rollback"
              }
            ],
            "alerts": [
              {
                "name": "High CPU Usage",
                "condition": "CPU > 80% for 5 minutes",
                "severity": "warning"
              },
              {
                "name": "Database Connections",
                "condition": "Connections > 80% of max",
                "severity": "critical"
              },
              {
                "name": "KDS Sync Failure",
                "condition": "Redis pub/sub latency > 500ms",
                "severity": "critical"
              }
            ],
            "logging": {
              "retention": "30d",
              "tools": [
                "Fluent Bit",
                "CloudWatch Logs",
                "Datadog Logs"
              ]
            }
          },
          "deployment": {
            "strategy": "blue-green",
            "environments": [
              {
                "name": "development",
                "configuration": {
                  "replicas": "1",
                  "resources": "small",
                  "debug": "true"
                },
                "description": "Ephemeral environments for feature testing."
              },
              {
                "name": "staging",
                "configuration": {
                  "replicas": "2",
                  "resources": "medium",
                  "db_anonymized": "true"
                },
                "description": "Pre-production environment mirroring prod config."
              },
              {
                "name": "production",
                "configuration": {
                  "replicas": "auto",
                  "resources": "large",
                  "multi_az": "true"
                },
                "description": "High-availability environment for end users."
              }
            ],
            "rollback_strategy": "Automated rollback via ArgoCD if health probes fail or error rate exceeds 1% within 5 minutes of deployment."
          },
          "scaling": {
            "auto_scaling": {
              "enabled": true,
              "max_replicas": 50,
              "metrics": {
                "requests_per_second": 1000,
                "active_connections": 5000
              },
              "min_replicas": 3,
              "target_cpu": 70,
              "target_memory": 80,
              "triggers": [
                {
                  "type": "cpu",
                  "threshold": "70%",
                  "metric": "CPU"
                },
                {
                  "type": "custom",
                  "threshold": "5000",
                  "metric": "ActiveSockets"
                }
              ]
            },
            "manual_scaling": {
              "replicas": 3
            }
          },
          "disaster_recovery": {
            "rpo": "5 minutes",
            "rto": "1 hour",
            "backup_strategy": "Automated daily RDS snapshots retained for 35 days. Continuous WAL archiving to S3 for Point-in-Time Recovery (PITR). Cross-region snapshot replication to us-west-2.",
            "failover_plan": "Trigger DNS failover via Route53 to secondary region. Promote Read Replica in us-west-2 to Primary. Scale up standby EKS cluster using Terraform."
          }
        },
        "timestamp": "2026-02-07T20:26:10.784Z"
      },
      "ui_design": {
        "step_id": "ui_design",
        "role": "UI Designer",
        "content": {
          "summary": "A unified design system prioritizing touch ergonomics for POS tablets and high-contrast legibility for Kitchen Display Systems, utilizing a shared React/React Native component library with strict accessibility compliance.",
          "description": "The visual language centers on 'Clarity under Pressure.' The POS interface uses large touch targets (min 48px) and distinct color coding to prevent errors during rush hours. The KDS utilizes dark mode by default to reduce glare, with high-contrast status indicators (Green/Yellow/Red) for ticket aging. The Admin portal follows a clean, data-dense dashboard layout using a 4pt grid system to manage complex inventory and reporting data effectively.",
          "design_tokens": {
            "colors": {
              "primary": "#4F46E5",
              "primary_foreground": "#FFFFFF",
              "secondary": "#64748B",
              "secondary_foreground": "#FFFFFF",
              "background": "#0F172A",
              "foreground": "#E2E8F0",
              "text": "#E2E8F0",
              "muted": "#1E293B",
              "muted_foreground": "#94A3B8",
              "card": "#111827",
              "card_foreground": "#E5E7EB",
              "popover": "#111827",
              "popover_foreground": "#E5E7EB",
              "border": "#334155",
              "input": "#334155",
              "ring": "#4F46E5",
              "accent": "#22D3EE",
              "accent_foreground": "#0F172A",
              "destructive": "#EF4444",
              "destructive_foreground": "#FFFFFF"
            },
            "spacing": {
              "xs": "0.25rem",
              "sm": "0.5rem",
              "md": "1rem",
              "lg": "1.5rem",
              "xl": "2rem",
              "2xl": "3rem",
              "3xl": "4rem"
            },
            "typography": {
              "fontFamily": "Inter, system-ui, sans-serif",
              "headingFont": "Inter, system-ui, sans-serif",
              "monoFont": "JetBrains Mono, monospace",
              "fontSize": {
                "xs": "0.75rem",
                "sm": "0.875rem",
                "base": "1rem",
                "lg": "1.125rem",
                "xl": "1.25rem",
                "2xl": "1.5rem",
                "3xl": "1.875rem"
              },
              "fontWeight": {
                "light": "300",
                "normal": "400",
                "medium": "500",
                "semibold": "600",
                "bold": "700"
              },
              "lineHeight": {
                "tight": "1.25",
                "normal": "1.5",
                "relaxed": "1.625",
                "loose": "2"
              }
            },
            "borderRadius": {
              "none": "0px",
              "sm": "0.125rem",
              "md": "0.375rem",
              "lg": "0.5rem",
              "xl": "0.75rem",
              "full": "9999px"
            },
            "shadows": {
              "sm": "0 1px 2px 0 rgb(0 0 0 / 0.05)",
              "md": "0 4px 6px -1px rgb(0 0 0 / 0.1)",
              "lg": "0 10px 15px -3px rgb(0 0 0 / 0.1)",
              "xl": "0 20px 25px -5px rgb(0 0 0 / 0.1)",
              "inner": "inset 0 2px 4px 0 rgb(0 0 0 / 0.05)",
              "none": "none"
            },
            "animations": {
              "fast": "150ms cubic-bezier(0.4, 0, 0.2, 1)",
              "normal": "300ms cubic-bezier(0.4, 0, 0.2, 1)",
              "slow": "500ms cubic-bezier(0.4, 0, 0.2, 1)"
            }
          },
          "component_hierarchy": {
            "root": "App",
            "children": [
              {
                "name": "AuthProvider",
                "props": [
                  "session: object"
                ]
              },
              {
                "name": "ThemeProvider",
                "props": [
                  "theme: string"
                ]
              },
              {
                "name": "Router",
                "children": [
                  {
                    "name": "POSLayout",
                    "props": [
                      "mode: tablet"
                    ]
                  },
                  {
                    "name": "KDSLayout",
                    "props": [
                      "station: string"
                    ]
                  },
                  {
                    "name": "AdminLayout",
                    "props": [
                      "role: manager"
                    ]
                  }
                ]
              }
            ]
          },
          "ui_patterns": [
            "Master-Detail Layout (POS Menu)",
            "Kanban Board (KDS Tickets)",
            "Interactive Floor Plan (Table Management)",
            "Modal Workflows (Modifiers/Splitting)",
            "Toast Notifications (System Alerts)"
          ],
          "component_specs": [
            {
              "name": "OrderTicket",
              "description": "Card component displaying a single order for the kitchen with timer and items.",
              "category": "organism",
              "props": [
                {
                  "name": "status",
                  "type": "string"
                },
                {
                  "name": "elapsedTime",
                  "type": "number"
                },
                {
                  "name": "items",
                  "type": "array"
                }
              ],
              "sizes": [
                "md",
                "lg"
              ],
              "states": [
                "new",
                "cooking",
                "late",
                "done"
              ],
              "variants": [
                "default",
                "urgent",
                "vip"
              ]
            },
            {
              "name": "TableNode",
              "description": "Interactive draggable table representation for the floor plan.",
              "category": "molecule",
              "props": [
                {
                  "name": "status",
                  "type": "string"
                },
                {
                  "name": "seats",
                  "type": "number"
                },
                {
                  "name": "shape",
                  "type": "string"
                }
              ],
              "sizes": [
                "sm",
                "md",
                "lg"
              ],
              "states": [
                "open",
                "seated",
                "billed",
                "dirty"
              ],
              "variants": [
                "round",
                "square",
                "booth"
              ]
            },
            {
              "name": "ModifierGrid",
              "description": "Grid of toggle buttons for selecting item customizations.",
              "category": "organism",
              "props": [
                {
                  "name": "options",
                  "type": "array"
                },
                {
                  "name": "multiSelect",
                  "type": "boolean"
                }
              ],
              "sizes": [
                "md"
              ],
              "states": [
                "default",
                "loading"
              ],
              "variants": [
                "default"
              ]
            }
          ],
          "layout_breakpoints": {
            "sm": "640px",
            "xl": "1280px"
          },
          "accessibility": {
            "standard": "WCAG 2.1 AA",
            "wcag_level": "AA"
          },
          "atomic_structure": {
            "atoms": [
              "Button",
              "Input",
              "Badge",
              "Icon",
              "Typography",
              "Avatar"
            ],
            "molecules": [
              "FormField",
              "SearchInput",
              "StatCard",
              "TableNode",
              "MenuItemCard"
            ],
            "organisms": [
              "OrderTicket",
              "FloorPlan",
              "Sidebar",
              "Header",
              "ModifierModal"
            ]
          },
          "website_layout": {
            "pages": [
              {
                "name": "POS Terminal",
                "route": "/pos",
                "sections": [
                  {
                    "name": "Floor Plan",
                    "components": [
                      "FloorMap",
                      "TableNode",
                      "ServerStatus"
                    ]
                  },
                  {
                    "name": "Order Entry",
                    "components": [
                      "MenuGrid",
                      "OrderSummary",
                      "ActionButtons"
                    ]
                  }
                ]
              },
              {
                "name": "Kitchen Display",
                "route": "/kds",
                "sections": [
                  {
                    "name": "Ticket Rail",
                    "components": [
                      "TicketGrid",
                      "OrderTicket",
                      "ExpediterBar"
                    ]
                  }
                ]
              },
              {
                "name": "Admin Dashboard",
                "route": "/admin",
                "sections": [
                  {
                    "name": "Overview",
                    "components": [
                      "SalesChart",
                      "InventoryAlerts",
                      "StaffList"
                    ]
                  }
                ]
              }
            ]
          }
        },
        "timestamp": "2026-02-07T20:26:47.533Z"
      },
      "engineer_impl": {
        "step_id": "engineer_impl",
        "role": "Engineer",
        "content": {
          "summary": "A monorepo-based, offline-first platform using React Native with WatermelonDB for POS resilience and NestJS with WebSockets for sub-200ms KDS synchronization.",
          "description": "The solution utilizes a Turborepo structure to share types and logic between the React Native POS, React KDS, and NestJS backend. The architecture centers on an 'Offline-First' approach for the POS using WatermelonDB and UUIDv7 to allow continuous operation during internet outages. Real-time updates are handled via a Redis-backed Socket.io cluster to ensure the kitchen receives orders instantly. The backend follows a modular monolith pattern to balance separation of concerns with deployment simplicity on AWS ECS.",
          "artifact_path": "restaurant-platform",
          "implementation_plan_phases": [
            {
              "name": "Phase 1: Foundation & Infrastructure",
              "description": "Setup monorepo, database schema, authentication, and core backend services.",
              "tasks": [
                "Initialize Turborepo with NestJS and React apps",
                "Provision PostgreSQL and Redis via Docker",
                "Implement UUIDv7 schema and migrations",
                "Setup Auth0 integration and JWT guards"
              ]
            },
            {
              "name": "Phase 2: POS Offline Engine",
              "description": "Develop the tablet POS with local-first data architecture.",
              "tasks": [
                "Configure WatermelonDB schema on React Native",
                "Implement offline order creation logic",
                "Build background sync mechanism with backend",
                "Create menu selection UI with modifiers"
              ]
            },
            {
              "name": "Phase 3: Real-time KDS",
              "description": "Build the Kitchen Display System with WebSocket synchronization.",
              "tasks": [
                "Implement Socket.io gateway in NestJS",
                "Create Redis Pub/Sub adapter for events",
                "Build KDS Kanban board UI",
                "Implement order bumping and status updates"
              ]
            },
            {
              "name": "Phase 4: Management & Polish",
              "description": "Table management, analytics, and production hardening.",
              "tasks": [
                "Develop drag-and-drop floor plan editor",
                "Implement bill splitting logic",
                "Configure AWS ECS and RDS pipelines",
                "Conduct load testing for WebSocket concurrency"
              ]
            }
          ],
          "state_management": {
            "tool": "WatermelonDB & React Query",
            "strategy": "POS uses local DB (Watermelon) for all data. KDS uses React Query for server state + Socket events for live updates."
          },
          "file_structure": {
            "name": "restaurant-platform",
            "type": "directory",
            "children": [
              {
                "name": "apps",
                "type": "directory",
                "children": [
                  {
                    "name": "api",
                    "type": "directory",
                    "children": [
                      {
                        "name": "src",
                        "type": "directory"
                      },
                      {
                        "name": "test",
                        "type": "directory"
                      },
                      {
                        "name": "Dockerfile",
                        "type": "file"
                      }
                    ]
                  },
                  {
                    "name": "pos-tablet",
                    "type": "directory",
                    "children": [
                      {
                        "name": "src",
                        "type": "directory"
                      },
                      {
                        "name": "ios",
                        "type": "directory"
                      },
                      {
                        "name": "android",
                        "type": "directory"
                      }
                    ]
                  },
                  {
                    "name": "kds-web",
                    "type": "directory",
                    "children": [
                      {
                        "name": "src",
                        "type": "directory"
                      },
                      {
                        "name": "public",
                        "type": "directory"
                      }
                    ]
                  }
                ]
              },
              {
                "name": "packages",
                "type": "directory",
                "children": [
                  {
                    "name": "shared-types",
                    "type": "directory",
                    "children": [
                      {
                        "name": "index.ts",
                        "type": "file"
                      }
                    ]
                  },
                  {
                    "name": "ui-kit",
                    "type": "directory",
                    "children": [
                      {
                        "name": "components",
                        "type": "directory"
                      }
                    ]
                  }
                ]
              },
              {
                "name": "docker-compose.yml",
                "type": "file"
              },
              {
                "name": "turbo.json",
                "type": "file"
              },
              {
                "name": "package.json",
                "type": "file"
              }
            ]
          },
          "technical_patterns": [
            "Repository Pattern",
            "Observer Pattern",
            "Adapter Pattern",
            "Offline Sync"
          ],
          "technical_decisions": [
            {
              "decision": "Use WatermelonDB for POS",
              "rationale": "Provides high-performance local SQLite wrapper with built-in sync primitives, essential for the 'offline-first' requirement.",
              "alternatives": "Redux Persist (too slow for large datasets), Realm (licensing/complexity)."
            },
            {
              "decision": "UUIDv7 for Primary Keys",
              "rationale": "Allows offline ID generation on tablets that is time-sortable, preventing index fragmentation and sync collisions.",
              "alternatives": "UUIDv4 (bad index performance), Auto-increment (impossible offline)."
            },
            {
              "decision": "NestJS with Socket.io",
              "rationale": "Provides a structured, scalable framework for handling both REST APIs and stateful WebSocket connections in a single codebase.",
              "alternatives": "Express (too loose), Fastify (good but less ecosystem for sockets)."
            },
            {
              "decision": "Turborepo Monorepo",
              "rationale": "Ensures type safety across the stack by sharing DTOs and interfaces between the API, POS, and KDS apps.",
              "alternatives": "Polyrepo (code duplication, sync issues)."
            }
          ],
          "environment_variables": [
            {
              "name": "DATABASE_URL",
              "description": "PostgreSQL connection string.",
              "example": "postgresql://user:pass@localhost:5432/db",
              "required": true
            },
            {
              "name": "REDIS_URL",
              "description": "Redis connection for Pub/Sub and caching.",
              "example": "redis://localhost:6379",
              "required": true
            },
            {
              "name": "JWT_SECRET",
              "description": "Secret key for signing auth tokens.",
              "example": "super-secret-key-change-me",
              "required": true
            },
            {
              "name": "STRIPE_SECRET_KEY",
              "description": "API key for payment processing.",
              "example": "sk_test_...",
              "required": true
            }
          ],
          "dependencies": [
            "react@18.2.0",
            "react-native@0.73.0",
            "@nestjs/core@10.3.0",
            "@nestjs/websockets@10.3.0",
            "socket.io-client@4.7.0",
            "@nozbe/watermelondb@0.27.0",
            "pg@8.11.0",
            "typeorm@0.3.20",
            "redis@4.6.0",
            "@tanstack/react-query@5.0.0",
            "tailwindcss@3.4.0",
            "zod@3.22.0",
            "uuid@9.0.0"
          ],
          "run_results": {
            "setup_commands": [
              "pnpm install",
              "docker-compose up -d",
              "pnpm db:migrate"
            ],
            "test_commands": [
              "pnpm test",
              "pnpm test:e2e"
            ],
            "dev_commands": [
              "pnpm dev",
              "pnpm --filter api dev"
            ],
            "build_commands": [
              "pnpm build",
              "pnpm type-check"
            ],
            "notes": "Ensure Docker is running for local DB/Redis. POS requires iOS/Android simulator."
          }
        },
        "timestamp": "2026-02-07T20:27:20.912Z"
      },
      "qa_verification": {
        "step_id": "qa_verification",
        "role": "QA",
        "content": {
          "ok": true,
          "test_strategy": {
            "unit": "Vitest for logic (pricing, bill splitting) and WatermelonDB models. React Testing Library for UI components. Mocking: MSW for network, factory-js for data entities. Target: 90% on core logic.",
            "integration": "Supertest for NestJS API endpoints. Testcontainers (Postgres/Redis) for DB/Cache interactions. Focus on WebSocket event emission and UUIDv7 generation uniqueness.",
            "e2e": "Playwright for critical paths: Order Entry -> Sync -> KDS Display. Custom fixtures to simulate offline/online network states. Runs on staging with seeded data.",
            "approach": "Heavy emphasis on Unit/Integration due to complex business logic (taxes, modifiers). E2E focuses on the 'Sync Engine' and Real-time WebSocket reliability across devices.",
            "tools": [
              "Vitest",
              "Playwright",
              "Supertest",
              "k6",
              "Testcontainers",
              "MSW"
            ],
            "types": [
              "unit",
              "integration",
              "e2e",
              "performance",
              "security",
              "accessibility"
            ]
          },
          "test_cases": [
            {
              "id": "TC-001",
              "title": "Digital Order Submission (Online)",
              "expected_result": "201 Created, WebSocket event broadcasted to KDS room",
              "type": "e2e",
              "priority": "high",
              "description": "Server submits order with modifiers via POS. Verify API response and immediate appearance on KDS screen via WebSocket."
            },
            {
              "id": "TC-002",
              "title": "Offline Order Queuing & Sync",
              "expected_result": "Order stored locally, synced automatically upon reconnection",
              "type": "e2e",
              "priority": "high",
              "description": "Disable network on POS. Create order. Verify local DB persistence. Re-enable network. Verify background sync POSTs data to backend."
            },
            {
              "id": "TC-003",
              "title": "Bill Splitting Calculation",
              "expected_result": "Split totals equal original total exactly (no rounding errors)",
              "type": "unit",
              "priority": "medium",
              "description": "Unit test splitting a $100.00 check 3 ways. Verify handling of remainder cents and tax distribution logic."
            },
            {
              "id": "TC-004",
              "title": "KDS Order Bumping",
              "expected_result": "Status updates to 'READY', POS receives notification",
              "type": "integration",
              "priority": "high",
              "description": "Send PATCH /orders/{id}/status. Verify DB update and Redis Pub/Sub event triggers update on POS client."
            },
            {
              "id": "TC-005",
              "title": "Menu Item 86 (Out of Stock)",
              "expected_result": "Item disabled on all POS terminals immediately",
              "type": "e2e",
              "priority": "medium",
              "description": "Manager marks item out of stock in Admin. Verify POS prevents selection of that item within 2 seconds."
            },
            {
              "id": "TC-006",
              "title": "Tenant Isolation (RLS)",
              "expected_result": "Query returns 0 records for other tenant's ID",
              "type": "integration",
              "priority": "high",
              "description": "Attempt to fetch orders using a valid JWT but requesting data belonging to a different restaurant_id."
            },
            {
              "id": "TC-007",
              "title": "WebSocket Load Stability",
              "expected_result": "Latency < 200ms at 500 concurrent connections",
              "type": "manual",
              "priority": "high",
              "description": "Use k6 to simulate 500 connected KDS clients receiving order events simultaneously."
            }
          ],
          "security_plan": {
            "auth_verification_steps": [
              "Verify JWT signature and expiration on every API call",
              "Test refresh token rotation mechanism on POS tablets",
              "Validate Row-Level Security policies prevent cross-tenant data access",
              "Check role-based access (Server cannot access Admin Menu Config)"
            ],
            "vulnerability_scan_strategy": "Weekly OWASP ZAP scans on staging API. Snyk scans on every PR for dependency vulnerabilities."
          },
          "manual_verification_steps": [
            "Verify physical receipt printer integration triggers on 'Bill' action",
            "Test tablet responsiveness in actual kitchen lighting (Dark Mode)",
            "Simulate Wi-Fi drop/reconnect during active transaction",
            "Verify touch targets on 10-inch tablet are easily tappable"
          ],
          "risk_analysis": [
            {
              "risk": "Offline Sync Conflicts",
              "impact": "high",
              "mitigation": "Strict UUIDv7 usage and 'Last-Write-Wins' logic tests."
            },
            {
              "risk": "WebSocket Message Loss",
              "impact": "high",
              "mitigation": "Implement application-level ACKs for critical KDS events."
            },
            {
              "risk": "Decimal Rounding Errors",
              "impact": "medium",
              "mitigation": "Use integer math (cents) for all monetary values in Unit tests."
            }
          ],
          "summary": "A hybrid testing strategy combining rigorous Unit testing for financial logic and offline-first data models, with targeted E2E tests validating the critical real-time synchronization loop between POS and KDS.",
          "description": "The QA plan prioritizes the system's ability to handle network instability and high-concurrency real-time events. Given the 'Offline-First' architecture using WatermelonDB, extensive integration testing will focus on the synchronization engine and UUIDv7 collision avoidance. Performance testing is critical to ensure the <200ms latency requirement is met via WebSockets. Security testing focuses on multi-tenant isolation via RLS.",
          "coverage": {
            "percentage": 80,
            "threshold": 80,
            "lines": 80,
            "statements": 80,
            "functions": 85,
            "branches": 75
          },
          "performance_metrics": {
            "api_response_time_p95": "200ms",
            "page_load_time": "2.0s",
            "database_query_time": "50ms",
            "first_contentful_paint": "1.5s",
            "time_to_interactive": "2.5s",
            "largest_contentful_paint": "2.5s"
          },
          "accessibility_plan": {
            "automated_tools": [
              "axe-core",
              "Lighthouse"
            ],
            "manual_checks": [
              "Color contrast in KDS Dark Mode",
              "Touch target size (>44px) for POS",
              "Screen reader announcements for new orders"
            ],
            "screen_readers": [
              "VoiceOver",
              "TalkBack"
            ],
            "standard": "WCAG 2.1 AA"
          },
          "manual_uat_plan": {
            "acceptance_criteria": [
              "Server can take an order in < 30 seconds",
              "Kitchen sees order in < 2 seconds",
              "Bill splitting works for groups of 4+"
            ],
            "scenarios": [
              "Full Dinner Service: Seat -> Order -> Cook -> Serve -> Split Bill -> Pay",
              "Kitchen Rush: 20 orders arriving within 1 minute",
              "Manager updates menu price while service is active"
            ],
            "stakeholders": [
              "Restaurant Owner",
              "Head Chef",
              "Lead Server"
            ]
          }
        },
        "timestamp": "2026-02-07T20:27:51.770Z"
      }
    },
    "metasop_report": {
      "events": [
        {
          "step_id": "pm_spec",
          "role": "Product Manager",
          "status": "running",
          "timestamp": "2026-02-07T20:23:15.271Z"
        },
        {
          "step_id": "pm_spec",
          "role": "Product Manager",
          "status": "success",
          "timestamp": "2026-02-07T20:23:57.135Z"
        },
        {
          "step_id": "arch_design",
          "role": "Architect",
          "status": "running",
          "timestamp": "2026-02-07T20:23:58.231Z"
        },
        {
          "step_id": "arch_design",
          "role": "Architect",
          "status": "success",
          "timestamp": "2026-02-07T20:24:46.932Z"
        },
        {
          "step_id": "security_architecture",
          "role": "Security",
          "status": "running",
          "timestamp": "2026-02-07T20:24:48.176Z"
        },
        {
          "step_id": "security_architecture",
          "role": "Security",
          "status": "success",
          "timestamp": "2026-02-07T20:25:27.863Z"
        },
        {
          "step_id": "devops_infrastructure",
          "role": "DevOps",
          "status": "running",
          "timestamp": "2026-02-07T20:25:27.873Z"
        },
        {
          "step_id": "devops_infrastructure",
          "role": "DevOps",
          "status": "success",
          "timestamp": "2026-02-07T20:26:10.789Z"
        },
        {
          "step_id": "ui_design",
          "role": "UI Designer",
          "status": "running",
          "timestamp": "2026-02-07T20:26:10.796Z"
        },
        {
          "step_id": "ui_design",
          "role": "UI Designer",
          "status": "success",
          "timestamp": "2026-02-07T20:26:47.539Z"
        },
        {
          "step_id": "engineer_impl",
          "role": "Engineer",
          "status": "running",
          "timestamp": "2026-02-07T20:26:47.546Z"
        },
        {
          "step_id": "engineer_impl",
          "role": "Engineer",
          "status": "success",
          "timestamp": "2026-02-07T20:27:20.927Z"
        },
        {
          "step_id": "qa_verification",
          "role": "QA",
          "status": "running",
          "timestamp": "2026-02-07T20:27:20.932Z"
        },
        {
          "step_id": "qa_verification",
          "role": "QA",
          "status": "success",
          "timestamp": "2026-02-07T20:27:51.772Z"
        }
      ]
    },
    "metasop_steps": [
      {
        "id": "pm_spec",
        "role": "Product Manager",
        "status": "success",
        "timestamp": "2026-02-07T20:23:57.135Z",
        "artifact": {
          "step_id": "pm_spec",
          "role": "Product Manager",
          "content": {
            "summary": "A cloud-native, real-time restaurant management platform integrating Point of Sale (POS), Kitchen Display Systems (KDS), and inventory analytics to streamline front and back-of-house operations.",
            "description": "This platform addresses the chaotic nature of restaurant operations by synchronizing data instantly between servers, the kitchen, and management. Targeted at mid-sized full-service restaurants, it replaces legacy paper-ticket systems with digital workflows. The core value proposition is increasing table turnover rates, reducing food waste through precise ordering, and providing owners with actionable real-time sales data.",
            "user_stories": [
              {
                "title": "Digital Order Entry",
                "story": "As a Server, I want to input customer orders on a handheld device so that the kitchen receives them instantly without manual tickets.",
                "description": "Develop a responsive POS interface for tablets allowing item selection, modifier customization (e.g., no onions), and order submission to the backend.",
                "priority": "critical",
                "story_points": 5,
                "acceptance_criteria": [
                  "Server can select items from categorized menu",
                  "Modifiers can be added to specific items",
                  "Order submission triggers real-time update to backend",
                  "UI provides visual confirmation of successful submission",
                  "Offline mode stores order locally until reconnected"
                ],
                "estimated_complexity": "medium",
                "user_value": "Reduces order errors and speeds up service time by 30%",
                "dependencies": [],
                "id": "US-1"
              },
              {
                "title": "Kitchen Display System (KDS)",
                "story": "As a Line Cook, I want to see incoming orders sorted by time and station so that I can prepare food in the correct sequence.",
                "description": "Create a real-time dashboard for kitchen screens that displays active orders, highlights long-wait items, and allows bumping orders when complete.",
                "priority": "critical",
                "story_points": 8,
                "acceptance_criteria": [
                  "Orders appear on KDS within 2 seconds of submission",
                  "Items are routed to specific stations (Grill vs Salad)",
                  "Color coding changes based on wait time thresholds",
                  "Cook can mark individual items or whole tickets as done",
                  "Recall function exists for accidentally closed tickets"
                ],
                "estimated_complexity": "large",
                "user_value": "Eliminates lost paper tickets and optimizes kitchen throughput",
                "dependencies": [
                  "US-1"
                ],
                "id": "US-2"
              },
              {
                "title": "Dynamic Table Management",
                "story": "As a Host, I want to see a visual map of table occupancy status so that I can seat walk-in guests efficiently.",
                "description": "Implement a drag-and-drop floor plan editor and a live view showing table status (Open, Seated, Billed, Dirty).",
                "priority": "high",
                "story_points": 5,
                "acceptance_criteria": [
                  "Map reflects real-time status changes from POS",
                  "Host can manually update table status",
                  "Hovering over a table shows current server and seating time",
                  "Layout supports multiple rooms/zones",
                  "Conflict alert if assigning a seated table"
                ],
                "estimated_complexity": "medium",
                "user_value": "Maximizes seating capacity and reduces customer wait times",
                "dependencies": [],
                "id": "US-3"
              },
              {
                "title": "Menu Configuration",
                "story": "As a Manager, I want to edit menu items, modifiers, and prices in real-time so that servers always have up-to-date information.",
                "description": "Build an admin panel for CRUD operations on menu categories, items, and pricing, including 86ing (out of stock) items.",
                "priority": "high",
                "story_points": 3,
                "acceptance_criteria": [
                  "Manager can add/edit/delete menu items",
                  "Price changes reflect immediately on POS terminals",
                  "Items can be marked as 'Out of Stock' globally",
                  "Supports time-based menus (Breakfast/Lunch/Dinner)",
                  "Audit log tracks who made changes and when"
                ],
                "estimated_complexity": "small",
                "user_value": "Ensures pricing accuracy and inventory availability",
                "dependencies": [],
                "id": "US-4"
              },
              {
                "title": "Bill Splitting",
                "story": "As a Server, I want to split a check by seat or specific items so that customers can pay separately.",
                "description": "Implement logic to divide a single order object into multiple sub-orders or payment transactions without data loss.",
                "priority": "medium",
                "story_points": 5,
                "acceptance_criteria": [
                  "Split by equal amounts (e.g., 1/3 each)",
                  "Split by specific items assigned to seats",
                  "Combined payment methods allowed (Cash + Card)",
                  "Original total matches sum of splits exactly",
                  "Receipts print individually for each split"
                ],
                "estimated_complexity": "medium",
                "user_value": "Improves customer satisfaction during payment process",
                "dependencies": [
                  "US-1"
                ],
                "id": "US-5"
              }
            ],
            "acceptance_criteria": [
              {
                "criteria": "System must handle 500 concurrent connections without latency exceeding 200ms.",
                "priority": "must",
                "description": "Performance requirement for peak hours.",
                "id": "AC-1",
                "title": "High Load Performance"
              },
              {
                "criteria": "All payment data must be encrypted and PCI-DSS compliant.",
                "priority": "must",
                "description": "Security compliance requirement.",
                "id": "AC-2",
                "title": "Security Compliance"
              },
              {
                "criteria": "UI must be fully functional on 10-inch tablets in landscape mode.",
                "priority": "should",
                "description": "Device compatibility standard.",
                "id": "AC-3",
                "title": "Tablet Responsiveness"
              },
              {
                "criteria": "System should support dark mode for low-light restaurant environments.",
                "priority": "could",
                "description": "Accessibility and UX enhancement.",
                "id": "AC-4",
                "title": "Dark Mode Support"
              }
            ],
            "ui_multi_section": true,
            "assumptions": [
              "Venue has reliable high-speed internet connection.",
              "Staff will use provided tablets (iPad or Android) for POS.",
              "Payment processing is handled via third-party API (Stripe/Square).",
              "Kitchen hardware supports HTML5 browser rendering."
            ],
            "out_of_scope": [
              "Delivery driver fleet tracking.",
              "Customer-facing mobile ordering app (Phase 2).",
              "Native payroll processing (integration only).",
              "Hardware procurement and installation services."
            ],
            "swot": {
              "strengths": [
                "Real-time WebSocket synchronization",
                "Hardware agnostic (runs on any browser)",
                "Intuitive UX requiring minimal training",
                "Lower cost than legacy hardware systems"
              ],
              "weaknesses": [
                "Dependency on internet connectivity",
                "Brand new market entrant vs established players",
                "Limited offline functionality in MVP",
                "No native hardware support"
              ],
              "opportunities": [
                "AI-driven inventory forecasting",
                "Self-service kiosk mode integration",
                "Partnerships with local food suppliers",
                "White-labeling for franchise chains"
              ],
              "threats": [
                "Aggressive pricing from Toast and Square",
                "Internet outages at client locations",
                "High cost of customer acquisition",
                "Data privacy regulation changes"
              ]
            },
            "stakeholders": [
              {
                "role": "Restaurant Owner",
                "interest": "ROI, theft prevention, and sales reporting",
                "influence": "high"
              },
              {
                "role": "Waitstaff",
                "interest": "Ease of use, speed of order entry, tip tracking",
                "influence": "medium"
              },
              {
                "role": "Head Chef",
                "interest": "Order clarity, timing accuracy, kitchen flow",
                "influence": "medium"
              },
              {
                "role": "Investors",
                "interest": "Market adoption and scalability",
                "influence": "high"
              }
            ],
            "invest_analysis": [
              {
                "user_story_id": "US-1",
                "independent": true,
                "negotiable": true,
                "valuable": true,
                "estimatable": true,
                "small": true,
                "testable": true,
                "score": 10,
                "comments": "Core feature, highly independent."
              },
              {
                "user_story_id": "US-2",
                "independent": false,
                "negotiable": true,
                "valuable": true,
                "estimatable": true,
                "small": false,
                "testable": true,
                "score": 7,
                "comments": "Depends on US-1; complex logic."
              },
              {
                "user_story_id": "US-3",
                "independent": true,
                "negotiable": true,
                "valuable": true,
                "estimatable": true,
                "small": true,
                "testable": true,
                "score": 9,
                "comments": "Can be built in parallel with POS."
              },
              {
                "user_story_id": "US-4",
                "independent": true,
                "negotiable": true,
                "valuable": true,
                "estimatable": true,
                "small": true,
                "testable": true,
                "score": 10,
                "comments": "Standard CRUD, low risk."
              },
              {
                "user_story_id": "US-5",
                "independent": false,
                "negotiable": true,
                "valuable": true,
                "estimatable": true,
                "small": true,
                "testable": true,
                "score": 8,
                "comments": "Complex math, depends on US-1."
              }
            ]
          },
          "timestamp": "2026-02-07T20:23:57.128Z"
        }
      },
      {
        "id": "arch_design",
        "role": "Architect",
        "status": "success",
        "timestamp": "2026-02-07T20:24:46.932Z",
        "artifact": {
          "step_id": "arch_design",
          "role": "Architect",
          "content": {
            "design_doc": "## System Architecture Overview\n\nThe Restaurant Management Platform is designed as a cloud-native, event-driven system to ensure sub-second synchronization between Point of Sale (POS) terminals and Kitchen Display Systems (KDS). The architecture prioritizes high availability, offline tolerance, and data consistency.\n\n### Core Components\n\n1.  **Client Layer**: \n    - **POS Tablet App**: A React Native application optimized for 10-inch tablets. It utilizes a local SQLite database (WatermelonDB) to store menu data and active orders, enabling full offline functionality. Synchronization occurs via a background sync engine when connectivity is restored.\n    - **KDS Web App**: A React-based Single Page Application (SPA) running on kitchen hardware. It relies on persistent WebSocket connections to receive real-time order tickets.\n    - **Manager Portal**: A web dashboard for menu configuration, floor plan editing, and analytics.\n\n2.  **API Gateway & Load Balancer**: \n    - Nginx acts as the entry point, handling SSL termination, rate limiting, and routing traffic to the backend services.\n\n3.  **Backend Services (Modular Monolith)**:\n    - Built with Node.js (NestJS), the backend is structured into domain modules (Orders, Inventory, Staff, Payments). \n    - **Real-time Engine**: A dedicated WebSocket service (Socket.io adapter backed by Redis) handles the broadcasting of events (e.g., `ORDER_CREATED`, `ITEM_BUMPED`) to connected KDS clients.\n\n4.  **Data Layer**:\n    - **Primary Database**: PostgreSQL serves as the source of truth for all transactional data. It uses a multi-tenant schema design (row-level security via `restaurant_id`).\n    - **Cache**: Redis is used for session management and caching frequently accessed menu data to reduce database load.\n\n### Data Flow\n\n1.  **Order Creation**: Server inputs order on POS -> Local DB save -> API POST (background sync) -> Backend validates -> DB Insert -> Event Published to Redis.\n2.  **Kitchen Notification**: Redis Subscriber -> WebSocket Service -> Broadcast to specific Restaurant Room -> KDS renders ticket.\n3.  **Completion**: Cook bumps order on KDS -> API PATCH -> DB Update -> WebSocket notifies POS (server alerted).\n\n### Offline Strategy\n\nTo satisfy the critical requirement of continuous operation, the POS generates UUIDv7 primary keys locally. This allows complex relational data (Orders -> OrderItems -> Modifiers) to be created without waiting for a server response. Conflict resolution uses a 'last-write-wins' strategy for status updates, while append-only logs are used for financial transactions.",
            "apis": [
              {
                "path": "/api/v1/orders",
                "method": "POST",
                "description": "Submit a new order from POS.",
                "request_schema": {
                  "tableId": "string",
                  "items": "array",
                  "serverNotes": "string"
                },
                "response_schema": {
                  "id": "string",
                  "status": "string",
                  "createdAt": "string"
                },
                "auth_required": true,
                "rate_limit": "60 req/min"
              },
              {
                "path": "/api/v1/orders",
                "method": "GET",
                "description": "Retrieve active orders for KDS.",
                "request_schema": {
                  "status": "string",
                  "limit": "number",
                  "cursor": "string"
                },
                "response_schema": {
                  "data": "array",
                  "nextCursor": "string"
                },
                "auth_required": true,
                "rate_limit": "100 req/min"
              },
              {
                "path": "/api/v1/orders/{id}/status",
                "method": "PATCH",
                "description": "Update order status (e.g., cooking, ready).",
                "request_schema": {
                  "status": "string",
                  "bumpedBy": "string"
                },
                "response_schema": {
                  "id": "string",
                  "status": "string",
                  "updatedAt": "string"
                },
                "auth_required": true,
                "rate_limit": "100 req/min"
              },
              {
                "path": "/api/v1/tables",
                "method": "GET",
                "description": "Get current floor plan status.",
                "request_schema": {},
                "response_schema": {
                  "tables": "array"
                },
                "auth_required": true,
                "rate_limit": "60 req/min"
              },
              {
                "path": "/api/v1/payments/split",
                "method": "POST",
                "description": "Split a bill into multiple sub-payments.",
                "request_schema": {
                  "orderId": "string",
                  "splits": "array"
                },
                "response_schema": {
                  "transactionIds": "array",
                  "remainingBalance": "number"
                },
                "auth_required": true,
                "rate_limit": "20 req/min"
              }
            ],
            "summary": "A high-performance, event-driven platform utilizing React Native for offline-first POS operations and WebSockets for real-time Kitchen Display System synchronization, backed by a scalable PostgreSQL/Node.js architecture.",
            "description": "The system replaces legacy restaurant workflows with a cloud-native solution. It features a distributed architecture where POS tablets operate with local databases (WatermelonDB) to ensure service continuity during internet outages, synchronizing with the central backend via UUIDv7 keys. The backend leverages Redis Pub/Sub to instantly route orders to specific kitchen stations, ensuring the 'High Load Performance' acceptance criteria is met.",
            "decisions": [
              {
                "decision": "Use PostgreSQL as primary database",
                "status": "accepted",
                "reason": "ACID compliance is non-negotiable for financial transactions and inventory management. Relational model fits the structured nature of Menus, Orders, and Tables perfectly.",
                "tradeoffs": "Schema migrations can be painful compared to NoSQL; scaling writes requires vertical scaling or sharding.",
                "consequences": "Must implement strict migration pipelines; use JSONB columns for flexible menu modifiers.",
                "alternatives": [
                  "MongoDB (rejected: lack of multi-document transactions in older versions, eventual consistency risks)",
                  "Firebase (rejected: querying capabilities too limited for complex reporting)"
                ]
              },
              {
                "decision": "Implement UUIDv7 for Primary Keys",
                "status": "accepted",
                "reason": "Allows offline generation of IDs on the client side (POS) that are time-sortable, preventing collision during sync and maintaining index locality.",
                "tradeoffs": "Slightly larger storage footprint than integers; slightly slower insert performance than sequential integers.",
                "consequences": "Frontend must include UUID generation library; DB schema must use UUID type.",
                "alternatives": [
                  "Auto-increment Integers (rejected: impossible to generate offline without collision)",
                  "UUIDv4 (rejected: poor database index performance due to randomness)"
                ]
              },
              {
                "decision": "Use WebSockets (Socket.io) for KDS Sync",
                "status": "accepted",
                "reason": "Polling introduces latency unacceptable for a high-paced kitchen environment. WebSockets provide sub-200ms updates required by AC-1.",
                "tradeoffs": "Requires maintaining stateful connections; scaling requires Redis adapter for pub/sub across nodes.",
                "consequences": "Need to configure sticky sessions in load balancer or use a stateless transport fallback.",
                "alternatives": [
                  "Short Polling (rejected: high server load, latency)",
                  "Server-Sent Events (considered: good for one-way, but we need bi-directional for bumping)"
                ]
              },
              {
                "decision": "Logical Multi-Tenancy (Row-Level Security)",
                "status": "accepted",
                "reason": "Cost-effective for mid-sized market. Physical isolation (one DB per client) is operationally complex and expensive to maintain for thousands of small restaurants.",
                "tradeoffs": "Risk of data leak if `restaurant_id` filter is missed in queries; noisy neighbor problem.",
                "consequences": "Must implement rigorous testing of tenant isolation; use RLS policies in Postgres as a safety net.",
                "alternatives": [
                  "Database-per-tenant (rejected: too expensive for target market)",
                  "Schema-per-tenant (rejected: migration complexity)"
                ]
              }
            ],
            "database_schema": {
              "tables": [
                {
                  "name": "restaurants",
                  "columns": [
                    {
                      "name": "id",
                      "type": "UUID",
                      "constraints": [
                        "PRIMARY KEY"
                      ],
                      "description": "Tenant ID"
                    },
                    {
                      "name": "name",
                      "type": "VARCHAR(100)",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Restaurant Name"
                    },
                    {
                      "name": "settings",
                      "type": "JSONB",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Config like tax rates, timezone"
                    }
                  ],
                  "description": "Tenant configuration",
                  "indexes": [
                    {
                      "columns": [
                        "id"
                      ],
                      "type": "btree"
                    }
                  ],
                  "relationships": []
                },
                {
                  "name": "orders",
                  "columns": [
                    {
                      "name": "id",
                      "type": "UUID",
                      "constraints": [
                        "PRIMARY KEY"
                      ],
                      "description": "UUIDv7"
                    },
                    {
                      "name": "restaurant_id",
                      "type": "UUID",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Tenant FK"
                    },
                    {
                      "name": "table_id",
                      "type": "UUID",
                      "constraints": [
                        "NULLABLE"
                      ],
                      "description": "Table FK"
                    },
                    {
                      "name": "status",
                      "type": "VARCHAR(20)",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "OPEN, SENT, BILLED, CLOSED"
                    },
                    {
                      "name": "total_amount",
                      "type": "DECIMAL(10,2)",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Final cost"
                    }
                  ],
                  "description": "Head of the order ticket",
                  "indexes": [
                    {
                      "columns": [
                        "restaurant_id",
                        "status"
                      ],
                      "type": "btree"
                    }
                  ],
                  "relationships": [
                    {
                      "type": "many-to-one",
                      "from": "restaurant_id",
                      "to": "restaurants.id"
                    },
                    {
                      "type": "many-to-one",
                      "from": "table_id",
                      "to": "tables.id"
                    }
                  ]
                },
                {
                  "name": "order_items",
                  "columns": [
                    {
                      "name": "id",
                      "type": "UUID",
                      "constraints": [
                        "PRIMARY KEY"
                      ],
                      "description": "UUIDv7"
                    },
                    {
                      "name": "order_id",
                      "type": "UUID",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Parent Order FK"
                    },
                    {
                      "name": "menu_item_id",
                      "type": "UUID",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Item FK"
                    },
                    {
                      "name": "modifiers",
                      "type": "JSONB",
                      "constraints": [
                        "DEFAULT '{}'"
                      ],
                      "description": "Customizations (No onions)"
                    },
                    {
                      "name": "status",
                      "type": "VARCHAR(20)",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "PENDING, COOKING, READY"
                    }
                  ],
                  "description": "Individual line items",
                  "indexes": [
                    {
                      "columns": [
                        "order_id"
                      ],
                      "type": "btree"
                    }
                  ],
                  "relationships": [
                    {
                      "type": "many-to-one",
                      "from": "order_id",
                      "to": "orders.id"
                    }
                  ]
                },
                {
                  "name": "tables",
                  "columns": [
                    {
                      "name": "id",
                      "type": "UUID",
                      "constraints": [
                        "PRIMARY KEY"
                      ],
                      "description": "UUIDv7"
                    },
                    {
                      "name": "restaurant_id",
                      "type": "UUID",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "Tenant FK"
                    },
                    {
                      "name": "status",
                      "type": "VARCHAR(20)",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "OPEN, SEATED, DIRTY"
                    },
                    {
                      "name": "coordinates",
                      "type": "JSONB",
                      "constraints": [
                        "NOT NULL"
                      ],
                      "description": "x, y, rotation"
                    }
                  ],
                  "description": "Physical layout configuration",
                  "indexes": [
                    {
                      "columns": [
                        "restaurant_id"
                      ],
                      "type": "btree"
                    }
                  ],
                  "relationships": [
                    {
                      "type": "many-to-one",
                      "from": "restaurant_id",
                      "to": "restaurants.id"
                    }
                  ]
                }
              ]
            },
            "technology_stack": {
              "frontend": [
                "React Native (Tablets)",
                "React (KDS/Admin)",
                "TailwindCSS",
                "WatermelonDB (Offline)"
              ],
              "backend": [
                "Node.js",
                "NestJS",
                "Socket.io",
                "TypeScript"
              ],
              "database": [
                "PostgreSQL 15",
                "Redis (Pub/Sub & Cache)"
              ],
              "authentication": [
                "Auth0",
                "JWT"
              ],
              "hosting": [
                "AWS ECS (Fargate)",
                "AWS RDS",
                "AWS ElastiCache"
              ],
              "other": [
                "Stripe API",
                "Docker",
                "Terraform"
              ]
            },
            "security_considerations": [
              "PCI-DSS compliance via Stripe Elements (no raw card data touches server)",
              "Row-Level Security (RLS) in PostgreSQL to enforce tenant isolation",
              "WAF (Web Application Firewall) to prevent DDoS on WebSocket endpoints",
              "Short-lived JWTs for POS terminals with refresh token rotation"
            ],
            "scalability_approach": {
              "caching_strategy": "Redis for session storage and high-read menu data. CDN for static assets (images).",
              "database_scaling": "Read replicas for analytics/reporting queries. Connection pooling via PgBouncer.",
              "horizontal_scaling": "Stateless backend services scaled via AWS Auto Scaling Groups based on CPU/Memory.",
              "performance_targets": "API latency < 100ms, WebSocket broadcast < 200ms, 99.9% uptime."
            },
            "integration_points": [
              {
                "service": "Stripe Connect",
                "purpose": "Payment processing and split checks",
                "api_docs": "https://stripe.com/docs/api"
              },
              {
                "service": "SendGrid",
                "purpose": "Emailing digital receipts to customers",
                "api_docs": "https://docs.sendgrid.com/api-reference"
              },
              {
                "service": "Auth0",
                "purpose": "Identity management for staff and owners",
                "api_docs": "https://auth0.com/docs/api"
              }
            ]
          },
          "timestamp": "2026-02-07T20:24:46.921Z"
        }
      },
      {
        "id": "security_architecture",
        "role": "Security",
        "status": "success",
        "timestamp": "2026-02-07T20:25:27.863Z",
        "artifact": {
          "step_id": "security_architecture",
          "role": "Security",
          "content": {
            "summary": "A Zero-Trust architecture enforcing strict multi-tenant isolation via PostgreSQL Row-Level Security and securing offline-first data synchronization with cryptographic validation. The system leverages AWS managed security services (WAF, KMS, Cognito/Auth0) to mitigate threats across the hybrid cloud/edge environment.",
            "description": "The security architecture is designed to protect a distributed, offline-capable restaurant platform. The primary attack surface involves the synchronization of data between untrusted POS tablets and the cloud backend. To mitigate tampering, the system employs server-side validation of all synced UUIDv7 records. Multi-tenancy is secured not just at the application layer, but enforced at the database level using PostgreSQL Row-Level Security (RLS) to prevent cross-tenant data leaks. Real-time WebSockets are protected via rate limiting and strict JWT authentication to prevent DoS. All sensitive data is encrypted at rest using envelope encryption via AWS KMS, and payments are offloaded to Stripe to minimize PCI-DSS scope.",
            "security_architecture": {
              "authentication": {
                "method": "JWT",
                "providers": [
                  "Auth0",
                  "Google",
                  "Email/Password"
                ],
                "mfa_enabled": true
              },
              "authorization": {
                "model": "RBAC",
                "roles": [
                  "owner",
                  "manager",
                  "server",
                  "cook"
                ],
                "policies": [
                  {
                    "resource": "orders",
                    "permissions": [
                      "create",
                      "read",
                      "update"
                    ],
                    "roles": [
                      "server",
                      "manager"
                    ]
                  },
                  {
                    "resource": "menu_config",
                    "permissions": [
                      "create",
                      "update",
                      "delete"
                    ],
                    "roles": [
                      "manager",
                      "owner"
                    ]
                  },
                  {
                    "resource": "financial_reports",
                    "permissions": [
                      "read"
                    ],
                    "roles": [
                      "owner"
                    ]
                  }
                ]
              },
              "session_management": {
                "http_only_cookies": true,
                "same_site_policy": "Strict",
                "secure_cookies": true,
                "session_timeout": "12h",
                "strategy": "stateless"
              },
              "audit_logging": {
                "enabled": true,
                "events": [
                  "login_success",
                  "login_failed",
                  "order_voided",
                  "menu_price_change",
                  "payment_refund"
                ],
                "retention": "1y",
                "storage_location": "AWS S3 (Immutable Object Lock)"
              }
            },
            "threat_model": [
              {
                "threat": "Cross-Tenant Data Leak via RLS Bypass",
                "mitigation": "Enforce Row-Level Security (RLS) on all tables with extensive unit tests for tenant isolation policies.",
                "severity": "critical",
                "affected_components": [
                  "PostgreSQL",
                  "API Layer"
                ],
                "category": "Information Disclosure",
                "cwe_ref": "CWE-200",
                "description": "An attacker exploits a flaw in the query logic to access data belonging to another restaurant tenant.",
                "impact": "Massive data breach, loss of customer trust, legal penalties.",
                "likelihood": "medium",
                "owasp_ref": "A01:2021 - Broken Access Control"
              },
              {
                "threat": "WebSocket Connection Exhaustion (DoS)",
                "mitigation": "Implement strict rate limiting per IP/Tenant and enforce max concurrent connection limits in Nginx and Socket.io.",
                "severity": "high",
                "affected_components": [
                  "Socket.io Service",
                  "Load Balancer"
                ],
                "category": "Denial of Service",
                "cwe_ref": "CWE-400",
                "description": "Malicious actor floods the WebSocket server with connection requests, preventing KDS updates.",
                "impact": "Kitchen operations halt, inability to process orders.",
                "likelihood": "medium",
                "owasp_ref": "A05:2021 - Security Misconfiguration"
              },
              {
                "threat": "Offline Transaction Tampering",
                "mitigation": "Implement cryptographic checksums for offline order batches and server-side validation of all synced data.",
                "severity": "high",
                "affected_components": [
                  "POS Tablet",
                  "Sync Engine"
                ],
                "category": "Tampering",
                "cwe_ref": "CWE-353",
                "description": "Attacker modifies local SQLite data on the tablet before connectivity is restored to alter prices or totals.",
                "impact": "Financial loss, inventory discrepancies.",
                "likelihood": "medium",
                "owasp_ref": "A08:2021 - Software and Data Integrity Failures"
              },
              {
                "threat": "Privilege Escalation via API Parameter Manipulation",
                "mitigation": "Strict DTO validation using Zod and backend role checks for every API endpoint, ignoring client-sent role params.",
                "severity": "critical",
                "affected_components": [
                  "API Layer",
                  "NestJS Guards"
                ],
                "category": "Elevation of Privilege",
                "cwe_ref": "CWE-269",
                "description": "A server modifies API requests to perform manager-level actions like voiding items or changing prices.",
                "impact": "Unauthorized financial changes, theft facilitation.",
                "likelihood": "medium",
                "owasp_ref": "A01:2021 - Broken Access Control"
              }
            ],
            "encryption": {
              "data_at_rest": {
                "method": "AES-256-GCM",
                "key_management": "AWS KMS (Key Management Service)",
                "description": "Full disk encryption for RDS and ElastiCache; field-level encryption for PII."
              },
              "data_in_transit": {
                "method": "TLS 1.3",
                "certificate_management": "AWS Certificate Manager (ACM) with auto-renewal",
                "description": "Enforced HTTPS for all API and WebSocket traffic; HSTS enabled."
              },
              "key_management": {
                "strategy": "Centralized Key Management via AWS KMS",
                "description": "Customer Master Keys (CMKs) managed in KMS with strict IAM usage policies.",
                "rotation_policy": "Automatic annual rotation"
              },
              "envelope_encryption": true,
              "secrets_management": "AWS Secrets Manager"
            },
            "security_controls": [
              {
                "control": "Web Application Firewall (WAF)",
                "implementation": "AWS WAF rules configured for SQLi, XSS, and rate limiting on API Gateway.",
                "category": "preventive",
                "description": "Filters malicious web traffic before it reaches the application.",
                "id": "SC-01",
                "priority": "critical",
                "type": "Network Security"
              },
              {
                "control": "Row-Level Security (RLS)",
                "implementation": "PostgreSQL policies enforcing 'restaurant_id' checks on every query.",
                "category": "preventive",
                "description": "Database-level isolation to prevent cross-tenant data leakage.",
                "id": "SC-02",
                "priority": "critical",
                "type": "Data Security"
              },
              {
                "control": "Automated Vulnerability Scanning",
                "implementation": "GitHub Dependabot for deps and AWS Inspector for container/EC2 scanning.",
                "category": "detective",
                "description": "Continuous monitoring of dependencies and infrastructure for CVEs.",
                "id": "SC-03",
                "priority": "high",
                "type": "Vulnerability Mgmt"
              },
              {
                "control": "Centralized Audit Logging",
                "implementation": "NestJS interceptors sending structured logs to CloudWatch/S3.",
                "category": "detective",
                "description": "Immutable record of all critical system actions for forensics.",
                "id": "SC-04",
                "priority": "high",
                "type": "Logging"
              }
            ],
            "compliance": [
              {
                "standard": "PCI-DSS",
                "requirements": [
                  "Requirement 3: Protect stored cardholder data",
                  "Requirement 4: Encrypt transmission of cardholder data"
                ],
                "implementation_status": "compliant",
                "description": "Utilizing Stripe Elements (SAQ-A) to ensure no raw card data touches our servers."
              },
              {
                "standard": "GDPR",
                "requirements": [
                  "Article 32: Security of processing",
                  "Article 17: Right to erasure"
                ],
                "implementation_status": "in-progress",
                "description": "Implementing automated data purging workflows and consent management for staff data."
              },
              {
                "standard": "SOC2",
                "requirements": [
                  "CC6.1: Logical Access Security",
                  "CC6.7: Transmission Security"
                ],
                "implementation_status": "planned",
                "description": "Establishing baseline controls for future audit readiness."
              }
            ],
            "vulnerability_management": {
              "remediation_sla": "Critical: 24h, High: 7d, Medium: 30d",
              "scanning_frequency": "Continuous (CI/CD) + Weekly Deep Scans",
              "tools": [
                "AWS Inspector",
                "Snyk",
                "OWASP ZAP",
                "Dependabot"
              ]
            },
            "security_monitoring": {
              "alerting_thresholds": "5 failed logins/min, >100 orders/min per tenant, >1% 5xx error rate",
              "logging_strategy": "Structured JSON logging with correlation IDs across microservices; centralized in CloudWatch.",
              "siem_solution": "AWS Security Hub / CloudWatch Logs Insights"
            }
          },
          "timestamp": "2026-02-07T20:25:27.858Z"
        }
      },
      {
        "id": "devops_infrastructure",
        "role": "DevOps",
        "status": "success",
        "timestamp": "2026-02-07T20:26:10.789Z",
        "artifact": {
          "step_id": "devops_infrastructure",
          "role": "DevOps",
          "content": {
            "summary": "A high-availability AWS infrastructure using EKS for container orchestration and RDS PostgreSQL, managed via Terraform to ensure sub-100ms latency and 99.9% uptime.",
            "description": "The infrastructure leverages AWS EKS to orchestrate the modular monolith, ensuring scalability for both the REST API and the WebSocket gateway. We utilize a Blue-Green deployment strategy via ArgoCD to minimize risk during updates. Data persistence is handled by Multi-AZ RDS PostgreSQL with strict security groups and IAM authentication. Redis ElastiCache is configured in Cluster Mode to handle high-throughput Pub/Sub events for the KDS. Observability is centralized in Datadog, monitoring business-critical metrics like 'Order-to-Kitchen' latency.",
            "infrastructure": {
              "cloud_provider": "AWS",
              "services": [
                {
                  "name": "eks-cluster",
                  "type": "compute",
                  "configuration": {
                    "version": "1.27",
                    "node_group": "managed",
                    "instance_types": "t3.medium, m5.large"
                  },
                  "description": "EKS cluster for container orchestration."
                },
                {
                  "name": "primary-db",
                  "type": "database",
                  "configuration": {
                    "engine": "postgres",
                    "version": "15.4",
                    "instance_class": "db.r6g.large",
                    "storage": "gp3"
                  },
                  "description": "Multi-AZ RDS PostgreSQL for transactional data."
                },
                {
                  "name": "redis-cache",
                  "type": "storage",
                  "configuration": {
                    "engine": "redis",
                    "cluster_mode": "enabled",
                    "node_type": "cache.t4g.medium"
                  },
                  "description": "ElastiCache for Pub/Sub and session management."
                },
                {
                  "name": "alb-ingress",
                  "type": "load-balancer",
                  "configuration": {
                    "scheme": "internet-facing",
                    "target_type": "ip",
                    "stickiness": "enabled"
                  },
                  "description": "Application Load Balancer with WebSocket support."
                }
              ],
              "regions": [
                "us-east-1",
                "us-west-2"
              ],
              "iac": "Terraform"
            },
            "cicd": {
              "pipeline_stages": [
                {
                  "name": "Build & Test",
                  "steps": [
                    "Checkout",
                    "Install Deps",
                    "Lint",
                    "Unit Tests",
                    "Build Docker Image"
                  ],
                  "goal": "Ensure code quality and create artifacts.",
                  "status": "active"
                },
                {
                  "name": "Security Scan",
                  "steps": [
                    "Container Scan (Trivy)",
                    "SAST (SonarQube)",
                    "Dependency Audit"
                  ],
                  "goal": "Detect vulnerabilities before deployment.",
                  "status": "active"
                },
                {
                  "name": "Deploy Staging",
                  "steps": [
                    "Terraform Plan",
                    "Terraform Apply",
                    "Helm Upgrade"
                  ],
                  "goal": "Deploy to pre-prod environment.",
                  "status": "active"
                },
                {
                  "name": "E2E Verification",
                  "steps": [
                    "Run Cypress Tests",
                    "Load Test (k6)"
                  ],
                  "goal": "Validate functionality under load.",
                  "status": "active"
                },
                {
                  "name": "Deploy Prod",
                  "steps": [
                    "Manual Approval",
                    "Canary Rollout",
                    "Health Check"
                  ],
                  "goal": "Release to production users.",
                  "status": "active"
                }
              ],
              "tools": [
                "GitHub Actions",
                "ArgoCD",
                "SonarQube"
              ],
              "triggers": [
                {
                  "type": "push",
                  "branch": "main",
                  "description": "Triggers build and staging deploy."
                },
                {
                  "type": "pull_request",
                  "branch": "*",
                  "description": "Triggers tests and linting."
                }
              ]
            },
            "containerization": {
              "docker_compose": "version: '3.8', services: { api: { build: '.', ports: ['3000:3000'] }, db: { image: 'postgres:15' } }",
              "dockerfile": "FROM node:18-alpine AS builder\nWORKDIR /app\nCOPY . .\nRUN npm ci && npm run build\nFROM node:18-alpine\nCOPY --from=builder /app/dist ./dist\nCMD [\"node\", \"dist/main\"]",
              "kubernetes": {
                "deployments": [
                  {
                    "name": "backend-api",
                    "replicas": 3,
                    "resources": {
                      "cpu": "500m",
                      "memory": "512Mi"
                    }
                  },
                  {
                    "name": "websocket-gateway",
                    "replicas": 5,
                    "resources": {
                      "cpu": "1",
                      "memory": "1Gi"
                    }
                  }
                ],
                "namespace": "restaurant-platform",
                "services": [
                  {
                    "name": "api-service",
                    "ports": [
                      {
                        "port": 80,
                        "targetPort": 3000
                      }
                    ],
                    "type": "ClusterIP"
                  },
                  {
                    "name": "ws-service",
                    "ports": [
                      {
                        "port": 80,
                        "targetPort": 8080
                      }
                    ],
                    "type": "LoadBalancer"
                  }
                ]
              }
            },
            "monitoring": {
              "tools": [
                "Datadog",
                "CloudWatch",
                "PagerDuty"
              ],
              "metrics": [
                {
                  "name": "API Latency",
                  "threshold": "100ms",
                  "action": "Scale Out / Alert Warning"
                },
                {
                  "name": "WebSocket Broadcast Lag",
                  "threshold": "200ms",
                  "action": "Alert Critical"
                },
                {
                  "name": "Error Rate",
                  "threshold": "1%",
                  "action": "Trigger Rollback"
                }
              ],
              "alerts": [
                {
                  "name": "High CPU Usage",
                  "condition": "CPU > 80% for 5 minutes",
                  "severity": "warning"
                },
                {
                  "name": "Database Connections",
                  "condition": "Connections > 80% of max",
                  "severity": "critical"
                },
                {
                  "name": "KDS Sync Failure",
                  "condition": "Redis pub/sub latency > 500ms",
                  "severity": "critical"
                }
              ],
              "logging": {
                "retention": "30d",
                "tools": [
                  "Fluent Bit",
                  "CloudWatch Logs",
                  "Datadog Logs"
                ]
              }
            },
            "deployment": {
              "strategy": "blue-green",
              "environments": [
                {
                  "name": "development",
                  "configuration": {
                    "replicas": "1",
                    "resources": "small",
                    "debug": "true"
                  },
                  "description": "Ephemeral environments for feature testing."
                },
                {
                  "name": "staging",
                  "configuration": {
                    "replicas": "2",
                    "resources": "medium",
                    "db_anonymized": "true"
                  },
                  "description": "Pre-production environment mirroring prod config."
                },
                {
                  "name": "production",
                  "configuration": {
                    "replicas": "auto",
                    "resources": "large",
                    "multi_az": "true"
                  },
                  "description": "High-availability environment for end users."
                }
              ],
              "rollback_strategy": "Automated rollback via ArgoCD if health probes fail or error rate exceeds 1% within 5 minutes of deployment."
            },
            "scaling": {
              "auto_scaling": {
                "enabled": true,
                "max_replicas": 50,
                "metrics": {
                  "requests_per_second": 1000,
                  "active_connections": 5000
                },
                "min_replicas": 3,
                "target_cpu": 70,
                "target_memory": 80,
                "triggers": [
                  {
                    "type": "cpu",
                    "threshold": "70%",
                    "metric": "CPU"
                  },
                  {
                    "type": "custom",
                    "threshold": "5000",
                    "metric": "ActiveSockets"
                  }
                ]
              },
              "manual_scaling": {
                "replicas": 3
              }
            },
            "disaster_recovery": {
              "rpo": "5 minutes",
              "rto": "1 hour",
              "backup_strategy": "Automated daily RDS snapshots retained for 35 days. Continuous WAL archiving to S3 for Point-in-Time Recovery (PITR). Cross-region snapshot replication to us-west-2.",
              "failover_plan": "Trigger DNS failover via Route53 to secondary region. Promote Read Replica in us-west-2 to Primary. Scale up standby EKS cluster using Terraform."
            }
          },
          "timestamp": "2026-02-07T20:26:10.784Z"
        }
      },
      {
        "id": "ui_design",
        "role": "UI Designer",
        "status": "success",
        "timestamp": "2026-02-07T20:26:47.539Z",
        "artifact": {
          "step_id": "ui_design",
          "role": "UI Designer",
          "content": {
            "summary": "A unified design system prioritizing touch ergonomics for POS tablets and high-contrast legibility for Kitchen Display Systems, utilizing a shared React/React Native component library with strict accessibility compliance.",
            "description": "The visual language centers on 'Clarity under Pressure.' The POS interface uses large touch targets (min 48px) and distinct color coding to prevent errors during rush hours. The KDS utilizes dark mode by default to reduce glare, with high-contrast status indicators (Green/Yellow/Red) for ticket aging. The Admin portal follows a clean, data-dense dashboard layout using a 4pt grid system to manage complex inventory and reporting data effectively.",
            "design_tokens": {
              "colors": {
                "primary": "#4F46E5",
                "primary_foreground": "#FFFFFF",
                "secondary": "#64748B",
                "secondary_foreground": "#FFFFFF",
                "background": "#0F172A",
                "foreground": "#E2E8F0",
                "text": "#E2E8F0",
                "muted": "#1E293B",
                "muted_foreground": "#94A3B8",
                "card": "#111827",
                "card_foreground": "#E5E7EB",
                "popover": "#111827",
                "popover_foreground": "#E5E7EB",
                "border": "#334155",
                "input": "#334155",
                "ring": "#4F46E5",
                "accent": "#22D3EE",
                "accent_foreground": "#0F172A",
                "destructive": "#EF4444",
                "destructive_foreground": "#FFFFFF"
              },
              "spacing": {
                "xs": "0.25rem",
                "sm": "0.5rem",
                "md": "1rem",
                "lg": "1.5rem",
                "xl": "2rem",
                "2xl": "3rem",
                "3xl": "4rem"
              },
              "typography": {
                "fontFamily": "Inter, system-ui, sans-serif",
                "headingFont": "Inter, system-ui, sans-serif",
                "monoFont": "JetBrains Mono, monospace",
                "fontSize": {
                  "xs": "0.75rem",
                  "sm": "0.875rem",
                  "base": "1rem",
                  "lg": "1.125rem",
                  "xl": "1.25rem",
                  "2xl": "1.5rem",
                  "3xl": "1.875rem"
                },
                "fontWeight": {
                  "light": "300",
                  "normal": "400",
                  "medium": "500",
                  "semibold": "600",
                  "bold": "700"
                },
                "lineHeight": {
                  "tight": "1.25",
                  "normal": "1.5",
                  "relaxed": "1.625",
                  "loose": "2"
                }
              },
              "borderRadius": {
                "none": "0px",
                "sm": "0.125rem",
                "md": "0.375rem",
                "lg": "0.5rem",
                "xl": "0.75rem",
                "full": "9999px"
              },
              "shadows": {
                "sm": "0 1px 2px 0 rgb(0 0 0 / 0.05)",
                "md": "0 4px 6px -1px rgb(0 0 0 / 0.1)",
                "lg": "0 10px 15px -3px rgb(0 0 0 / 0.1)",
                "xl": "0 20px 25px -5px rgb(0 0 0 / 0.1)",
                "inner": "inset 0 2px 4px 0 rgb(0 0 0 / 0.05)",
                "none": "none"
              },
              "animations": {
                "fast": "150ms cubic-bezier(0.4, 0, 0.2, 1)",
                "normal": "300ms cubic-bezier(0.4, 0, 0.2, 1)",
                "slow": "500ms cubic-bezier(0.4, 0, 0.2, 1)"
              }
            },
            "component_hierarchy": {
              "root": "App",
              "children": [
                {
                  "name": "AuthProvider",
                  "props": [
                    "session: object"
                  ]
                },
                {
                  "name": "ThemeProvider",
                  "props": [
                    "theme: string"
                  ]
                },
                {
                  "name": "Router",
                  "children": [
                    {
                      "name": "POSLayout",
                      "props": [
                        "mode: tablet"
                      ]
                    },
                    {
                      "name": "KDSLayout",
                      "props": [
                        "station: string"
                      ]
                    },
                    {
                      "name": "AdminLayout",
                      "props": [
                        "role: manager"
                      ]
                    }
                  ]
                }
              ]
            },
            "ui_patterns": [
              "Master-Detail Layout (POS Menu)",
              "Kanban Board (KDS Tickets)",
              "Interactive Floor Plan (Table Management)",
              "Modal Workflows (Modifiers/Splitting)",
              "Toast Notifications (System Alerts)"
            ],
            "component_specs": [
              {
                "name": "OrderTicket",
                "description": "Card component displaying a single order for the kitchen with timer and items.",
                "category": "organism",
                "props": [
                  {
                    "name": "status",
                    "type": "string"
                  },
                  {
                    "name": "elapsedTime",
                    "type": "number"
                  },
                  {
                    "name": "items",
                    "type": "array"
                  }
                ],
                "sizes": [
                  "md",
                  "lg"
                ],
                "states": [
                  "new",
                  "cooking",
                  "late",
                  "done"
                ],
                "variants": [
                  "default",
                  "urgent",
                  "vip"
                ]
              },
              {
                "name": "TableNode",
                "description": "Interactive draggable table representation for the floor plan.",
                "category": "molecule",
                "props": [
                  {
                    "name": "status",
                    "type": "string"
                  },
                  {
                    "name": "seats",
                    "type": "number"
                  },
                  {
                    "name": "shape",
                    "type": "string"
                  }
                ],
                "sizes": [
                  "sm",
                  "md",
                  "lg"
                ],
                "states": [
                  "open",
                  "seated",
                  "billed",
                  "dirty"
                ],
                "variants": [
                  "round",
                  "square",
                  "booth"
                ]
              },
              {
                "name": "ModifierGrid",
                "description": "Grid of toggle buttons for selecting item customizations.",
                "category": "organism",
                "props": [
                  {
                    "name": "options",
                    "type": "array"
                  },
                  {
                    "name": "multiSelect",
                    "type": "boolean"
                  }
                ],
                "sizes": [
                  "md"
                ],
                "states": [
                  "default",
                  "loading"
                ],
                "variants": [
                  "default"
                ]
              }
            ],
            "layout_breakpoints": {
              "sm": "640px",
              "xl": "1280px"
            },
            "accessibility": {
              "standard": "WCAG 2.1 AA",
              "wcag_level": "AA"
            },
            "atomic_structure": {
              "atoms": [
                "Button",
                "Input",
                "Badge",
                "Icon",
                "Typography",
                "Avatar"
              ],
              "molecules": [
                "FormField",
                "SearchInput",
                "StatCard",
                "TableNode",
                "MenuItemCard"
              ],
              "organisms": [
                "OrderTicket",
                "FloorPlan",
                "Sidebar",
                "Header",
                "ModifierModal"
              ]
            },
            "website_layout": {
              "pages": [
                {
                  "name": "POS Terminal",
                  "route": "/pos",
                  "sections": [
                    {
                      "name": "Floor Plan",
                      "components": [
                        "FloorMap",
                        "TableNode",
                        "ServerStatus"
                      ]
                    },
                    {
                      "name": "Order Entry",
                      "components": [
                        "MenuGrid",
                        "OrderSummary",
                        "ActionButtons"
                      ]
                    }
                  ]
                },
                {
                  "name": "Kitchen Display",
                  "route": "/kds",
                  "sections": [
                    {
                      "name": "Ticket Rail",
                      "components": [
                        "TicketGrid",
                        "OrderTicket",
                        "ExpediterBar"
                      ]
                    }
                  ]
                },
                {
                  "name": "Admin Dashboard",
                  "route": "/admin",
                  "sections": [
                    {
                      "name": "Overview",
                      "components": [
                        "SalesChart",
                        "InventoryAlerts",
                        "StaffList"
                      ]
                    }
                  ]
                }
              ]
            }
          },
          "timestamp": "2026-02-07T20:26:47.533Z"
        }
      },
      {
        "id": "engineer_impl",
        "role": "Engineer",
        "status": "success",
        "timestamp": "2026-02-07T20:27:20.927Z",
        "artifact": {
          "step_id": "engineer_impl",
          "role": "Engineer",
          "content": {
            "summary": "A monorepo-based, offline-first platform using React Native with WatermelonDB for POS resilience and NestJS with WebSockets for sub-200ms KDS synchronization.",
            "description": "The solution utilizes a Turborepo structure to share types and logic between the React Native POS, React KDS, and NestJS backend. The architecture centers on an 'Offline-First' approach for the POS using WatermelonDB and UUIDv7 to allow continuous operation during internet outages. Real-time updates are handled via a Redis-backed Socket.io cluster to ensure the kitchen receives orders instantly. The backend follows a modular monolith pattern to balance separation of concerns with deployment simplicity on AWS ECS.",
            "artifact_path": "restaurant-platform",
            "implementation_plan_phases": [
              {
                "name": "Phase 1: Foundation & Infrastructure",
                "description": "Setup monorepo, database schema, authentication, and core backend services.",
                "tasks": [
                  "Initialize Turborepo with NestJS and React apps",
                  "Provision PostgreSQL and Redis via Docker",
                  "Implement UUIDv7 schema and migrations",
                  "Setup Auth0 integration and JWT guards"
                ]
              },
              {
                "name": "Phase 2: POS Offline Engine",
                "description": "Develop the tablet POS with local-first data architecture.",
                "tasks": [
                  "Configure WatermelonDB schema on React Native",
                  "Implement offline order creation logic",
                  "Build background sync mechanism with backend",
                  "Create menu selection UI with modifiers"
                ]
              },
              {
                "name": "Phase 3: Real-time KDS",
                "description": "Build the Kitchen Display System with WebSocket synchronization.",
                "tasks": [
                  "Implement Socket.io gateway in NestJS",
                  "Create Redis Pub/Sub adapter for events",
                  "Build KDS Kanban board UI",
                  "Implement order bumping and status updates"
                ]
              },
              {
                "name": "Phase 4: Management & Polish",
                "description": "Table management, analytics, and production hardening.",
                "tasks": [
                  "Develop drag-and-drop floor plan editor",
                  "Implement bill splitting logic",
                  "Configure AWS ECS and RDS pipelines",
                  "Conduct load testing for WebSocket concurrency"
                ]
              }
            ],
            "state_management": {
              "tool": "WatermelonDB & React Query",
              "strategy": "POS uses local DB (Watermelon) for all data. KDS uses React Query for server state + Socket events for live updates."
            },
            "file_structure": {
              "name": "restaurant-platform",
              "type": "directory",
              "children": [
                {
                  "name": "apps",
                  "type": "directory",
                  "children": [
                    {
                      "name": "api",
                      "type": "directory",
                      "children": [
                        {
                          "name": "src",
                          "type": "directory"
                        },
                        {
                          "name": "test",
                          "type": "directory"
                        },
                        {
                          "name": "Dockerfile",
                          "type": "file"
                        }
                      ]
                    },
                    {
                      "name": "pos-tablet",
                      "type": "directory",
                      "children": [
                        {
                          "name": "src",
                          "type": "directory"
                        },
                        {
                          "name": "ios",
                          "type": "directory"
                        },
                        {
                          "name": "android",
                          "type": "directory"
                        }
                      ]
                    },
                    {
                      "name": "kds-web",
                      "type": "directory",
                      "children": [
                        {
                          "name": "src",
                          "type": "directory"
                        },
                        {
                          "name": "public",
                          "type": "directory"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "packages",
                  "type": "directory",
                  "children": [
                    {
                      "name": "shared-types",
                      "type": "directory",
                      "children": [
                        {
                          "name": "index.ts",
                          "type": "file"
                        }
                      ]
                    },
                    {
                      "name": "ui-kit",
                      "type": "directory",
                      "children": [
                        {
                          "name": "components",
                          "type": "directory"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "docker-compose.yml",
                  "type": "file"
                },
                {
                  "name": "turbo.json",
                  "type": "file"
                },
                {
                  "name": "package.json",
                  "type": "file"
                }
              ]
            },
            "technical_patterns": [
              "Repository Pattern",
              "Observer Pattern",
              "Adapter Pattern",
              "Offline Sync"
            ],
            "technical_decisions": [
              {
                "decision": "Use WatermelonDB for POS",
                "rationale": "Provides high-performance local SQLite wrapper with built-in sync primitives, essential for the 'offline-first' requirement.",
                "alternatives": "Redux Persist (too slow for large datasets), Realm (licensing/complexity)."
              },
              {
                "decision": "UUIDv7 for Primary Keys",
                "rationale": "Allows offline ID generation on tablets that is time-sortable, preventing index fragmentation and sync collisions.",
                "alternatives": "UUIDv4 (bad index performance), Auto-increment (impossible offline)."
              },
              {
                "decision": "NestJS with Socket.io",
                "rationale": "Provides a structured, scalable framework for handling both REST APIs and stateful WebSocket connections in a single codebase.",
                "alternatives": "Express (too loose), Fastify (good but less ecosystem for sockets)."
              },
              {
                "decision": "Turborepo Monorepo",
                "rationale": "Ensures type safety across the stack by sharing DTOs and interfaces between the API, POS, and KDS apps.",
                "alternatives": "Polyrepo (code duplication, sync issues)."
              }
            ],
            "environment_variables": [
              {
                "name": "DATABASE_URL",
                "description": "PostgreSQL connection string.",
                "example": "postgresql://user:pass@localhost:5432/db",
                "required": true
              },
              {
                "name": "REDIS_URL",
                "description": "Redis connection for Pub/Sub and caching.",
                "example": "redis://localhost:6379",
                "required": true
              },
              {
                "name": "JWT_SECRET",
                "description": "Secret key for signing auth tokens.",
                "example": "super-secret-key-change-me",
                "required": true
              },
              {
                "name": "STRIPE_SECRET_KEY",
                "description": "API key for payment processing.",
                "example": "sk_test_...",
                "required": true
              }
            ],
            "dependencies": [
              "react@18.2.0",
              "react-native@0.73.0",
              "@nestjs/core@10.3.0",
              "@nestjs/websockets@10.3.0",
              "socket.io-client@4.7.0",
              "@nozbe/watermelondb@0.27.0",
              "pg@8.11.0",
              "typeorm@0.3.20",
              "redis@4.6.0",
              "@tanstack/react-query@5.0.0",
              "tailwindcss@3.4.0",
              "zod@3.22.0",
              "uuid@9.0.0"
            ],
            "run_results": {
              "setup_commands": [
                "pnpm install",
                "docker-compose up -d",
                "pnpm db:migrate"
              ],
              "test_commands": [
                "pnpm test",
                "pnpm test:e2e"
              ],
              "dev_commands": [
                "pnpm dev",
                "pnpm --filter api dev"
              ],
              "build_commands": [
                "pnpm build",
                "pnpm type-check"
              ],
              "notes": "Ensure Docker is running for local DB/Redis. POS requires iOS/Android simulator."
            }
          },
          "timestamp": "2026-02-07T20:27:20.912Z"
        }
      },
      {
        "id": "qa_verification",
        "role": "QA",
        "status": "success",
        "timestamp": "2026-02-07T20:27:51.772Z",
        "artifact": {
          "step_id": "qa_verification",
          "role": "QA",
          "content": {
            "ok": true,
            "test_strategy": {
              "unit": "Vitest for logic (pricing, bill splitting) and WatermelonDB models. React Testing Library for UI components. Mocking: MSW for network, factory-js for data entities. Target: 90% on core logic.",
              "integration": "Supertest for NestJS API endpoints. Testcontainers (Postgres/Redis) for DB/Cache interactions. Focus on WebSocket event emission and UUIDv7 generation uniqueness.",
              "e2e": "Playwright for critical paths: Order Entry -> Sync -> KDS Display. Custom fixtures to simulate offline/online network states. Runs on staging with seeded data.",
              "approach": "Heavy emphasis on Unit/Integration due to complex business logic (taxes, modifiers). E2E focuses on the 'Sync Engine' and Real-time WebSocket reliability across devices.",
              "tools": [
                "Vitest",
                "Playwright",
                "Supertest",
                "k6",
                "Testcontainers",
                "MSW"
              ],
              "types": [
                "unit",
                "integration",
                "e2e",
                "performance",
                "security",
                "accessibility"
              ]
            },
            "test_cases": [
              {
                "id": "TC-001",
                "title": "Digital Order Submission (Online)",
                "expected_result": "201 Created, WebSocket event broadcasted to KDS room",
                "type": "e2e",
                "priority": "high",
                "description": "Server submits order with modifiers via POS. Verify API response and immediate appearance on KDS screen via WebSocket."
              },
              {
                "id": "TC-002",
                "title": "Offline Order Queuing & Sync",
                "expected_result": "Order stored locally, synced automatically upon reconnection",
                "type": "e2e",
                "priority": "high",
                "description": "Disable network on POS. Create order. Verify local DB persistence. Re-enable network. Verify background sync POSTs data to backend."
              },
              {
                "id": "TC-003",
                "title": "Bill Splitting Calculation",
                "expected_result": "Split totals equal original total exactly (no rounding errors)",
                "type": "unit",
                "priority": "medium",
                "description": "Unit test splitting a $100.00 check 3 ways. Verify handling of remainder cents and tax distribution logic."
              },
              {
                "id": "TC-004",
                "title": "KDS Order Bumping",
                "expected_result": "Status updates to 'READY', POS receives notification",
                "type": "integration",
                "priority": "high",
                "description": "Send PATCH /orders/{id}/status. Verify DB update and Redis Pub/Sub event triggers update on POS client."
              },
              {
                "id": "TC-005",
                "title": "Menu Item 86 (Out of Stock)",
                "expected_result": "Item disabled on all POS terminals immediately",
                "type": "e2e",
                "priority": "medium",
                "description": "Manager marks item out of stock in Admin. Verify POS prevents selection of that item within 2 seconds."
              },
              {
                "id": "TC-006",
                "title": "Tenant Isolation (RLS)",
                "expected_result": "Query returns 0 records for other tenant's ID",
                "type": "integration",
                "priority": "high",
                "description": "Attempt to fetch orders using a valid JWT but requesting data belonging to a different restaurant_id."
              },
              {
                "id": "TC-007",
                "title": "WebSocket Load Stability",
                "expected_result": "Latency < 200ms at 500 concurrent connections",
                "type": "manual",
                "priority": "high",
                "description": "Use k6 to simulate 500 connected KDS clients receiving order events simultaneously."
              }
            ],
            "security_plan": {
              "auth_verification_steps": [
                "Verify JWT signature and expiration on every API call",
                "Test refresh token rotation mechanism on POS tablets",
                "Validate Row-Level Security policies prevent cross-tenant data access",
                "Check role-based access (Server cannot access Admin Menu Config)"
              ],
              "vulnerability_scan_strategy": "Weekly OWASP ZAP scans on staging API. Snyk scans on every PR for dependency vulnerabilities."
            },
            "manual_verification_steps": [
              "Verify physical receipt printer integration triggers on 'Bill' action",
              "Test tablet responsiveness in actual kitchen lighting (Dark Mode)",
              "Simulate Wi-Fi drop/reconnect during active transaction",
              "Verify touch targets on 10-inch tablet are easily tappable"
            ],
            "risk_analysis": [
              {
                "risk": "Offline Sync Conflicts",
                "impact": "high",
                "mitigation": "Strict UUIDv7 usage and 'Last-Write-Wins' logic tests."
              },
              {
                "risk": "WebSocket Message Loss",
                "impact": "high",
                "mitigation": "Implement application-level ACKs for critical KDS events."
              },
              {
                "risk": "Decimal Rounding Errors",
                "impact": "medium",
                "mitigation": "Use integer math (cents) for all monetary values in Unit tests."
              }
            ],
            "summary": "A hybrid testing strategy combining rigorous Unit testing for financial logic and offline-first data models, with targeted E2E tests validating the critical real-time synchronization loop between POS and KDS.",
            "description": "The QA plan prioritizes the system's ability to handle network instability and high-concurrency real-time events. Given the 'Offline-First' architecture using WatermelonDB, extensive integration testing will focus on the synchronization engine and UUIDv7 collision avoidance. Performance testing is critical to ensure the <200ms latency requirement is met via WebSockets. Security testing focuses on multi-tenant isolation via RLS.",
            "coverage": {
              "percentage": 80,
              "threshold": 80,
              "lines": 80,
              "statements": 80,
              "functions": 85,
              "branches": 75
            },
            "performance_metrics": {
              "api_response_time_p95": "200ms",
              "page_load_time": "2.0s",
              "database_query_time": "50ms",
              "first_contentful_paint": "1.5s",
              "time_to_interactive": "2.5s",
              "largest_contentful_paint": "2.5s"
            },
            "accessibility_plan": {
              "automated_tools": [
                "axe-core",
                "Lighthouse"
              ],
              "manual_checks": [
                "Color contrast in KDS Dark Mode",
                "Touch target size (>44px) for POS",
                "Screen reader announcements for new orders"
              ],
              "screen_readers": [
                "VoiceOver",
                "TalkBack"
              ],
              "standard": "WCAG 2.1 AA"
            },
            "manual_uat_plan": {
              "acceptance_criteria": [
                "Server can take an order in < 30 seconds",
                "Kitchen sees order in < 2 seconds",
                "Bill splitting works for groups of 4+"
              ],
              "scenarios": [
                "Full Dinner Service: Seat -> Order -> Cook -> Serve -> Split Bill -> Pay",
                "Kitchen Rush: 20 orders arriving within 1 minute",
                "Manager updates menu price while service is active"
              ],
              "stakeholders": [
                "Restaurant Owner",
                "Head Chef",
                "Lead Server"
              ]
            }
          },
          "timestamp": "2026-02-07T20:27:51.770Z"
        }
      }
    ],
    "generated_at": "2026-02-07T20:27:51.777Z"
  },
  "createdAt": "2026-02-07T20:23:15.218Z",
  "updatedAt": "2026-02-07T20:27:51.790Z"
}