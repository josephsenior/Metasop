{
  "step_id": "security_architecture",
  "role": "Security",
  "content": {
    "summary": "EduPulse employs a zero-trust security model centered on identity-first principles and robust data protection. By combining OAuth2/OIDC for identity, AES-256/TLS 1.3 for encryption, and CloudFront Signed URLs for content protection, the platform ensures a secure environment for both intellectual property and user PII.",
    "description": "The security architecture is designed to meet the high-concurrency and high-availability needs of a modern e-learning platform. It leverages cloud-native security services for automated threat detection and key management, while implementing application-level controls like RBAC and RLS to maintain strict data isolation across its microservices ecosystem.",
    "security_architecture": {
      "authentication": {
        "method": "OAuth2",
        "description": "Centralized identity management using OIDC with Auth0 to handle social logins and JWT issuance. Multi-factor authentication is enforced for instructor and administrative accounts to protect high-value content and system settings.",
        "mfa_enabled": true,
        "multi_factor_auth": true,
        "providers": [
          "Google",
          "LinkedIn"
        ],
        "refresh_tokens": true,
        "token_expiry": "1h"
      },
      "authorization": {
        "model": "RBAC",
        "description": "Role-Based Access Control managed at the API Gateway and enforced via JWT claims. Fine-grained access to specific course resources is further validated using Row Level Security (RLS) within the database layer.",
        "policies": [
          {
            "resource": "course_content",
            "permissions": [
              "read",
              "stream"
            ],
            "description": "Allows learners to view and stream content for enrolled courses.",
            "roles": [
              "learner"
            ]
          },
          {
            "resource": "curriculum_management",
            "permissions": [
              "create",
              "update",
              "delete"
            ],
            "description": "Allows instructors to manage their own course materials and structure.",
            "roles": [
              "instructor"
            ]
          }
        ],
        "roles": [
          "learner",
          "instructor",
          "admin"
        ]
      },
      "session_management": {
        "http_only_cookies": true,
        "same_site_policy": "lax",
        "secure_cookies": true,
        "session_timeout": "24h",
        "strategy": "stateless"
      }
    },
    "threat_model": [
      {
        "threat": "Unauthorized Video Access (Information Disclosure)",
        "severity": "high",
        "mitigation": "Implement CloudFront Signed URLs with short expiration times to ensure only authenticated learners can stream content.",
        "affected_components": [
          "CloudFront",
          "S3",
          "Video Service"
        ],
        "impact": "Loss of revenue and intellectual property due to content piracy.",
        "likelihood": "high"
      },
      {
        "threat": "Course Price Manipulation (Tampering)",
        "severity": "critical",
        "mitigation": "Server-side validation of course prices during checkout against the authoritative database record.",
        "affected_components": [
          "Payment Service",
          "Checkout API"
        ],
        "impact": "Financial loss and exploitation of the payment workflow.",
        "likelihood": "medium"
      },
      {
        "threat": "Account Takeover via Social Auth (Spoofing)",
        "severity": "high",
        "mitigation": "Strict validation of OAuth2 state parameters and nonce values to prevent CSRF and replay attacks.",
        "affected_components": [
          "Identity Service",
          "Auth API"
        ],
        "impact": "Unauthorized access to user PII and purchased content.",
        "likelihood": "medium"
      },
      {
        "threat": "API Denial of Service (DoS)",
        "severity": "medium",
        "mitigation": "Implement rate limiting and request throttling at the API Gateway level based on IP and User ID.",
        "affected_components": [
          "API Gateway",
          "All Microservices"
        ],
        "impact": "Platform unavailability for legitimate users during peak times.",
        "likelihood": "high"
      },
      {
        "threat": "SQL Injection in Search (Tampering/Disclosure)",
        "severity": "high",
        "mitigation": "Use parameterized queries and leverage Elasticsearch's DSL which is inherently resistant to traditional SQLi.",
        "affected_components": [
          "Search Service",
          "Elasticsearch"
        ],
        "impact": "Potential data leak or corruption of the search index.",
        "likelihood": "low"
      },
      {
        "threat": "Privilege Escalation to Admin (Elevation of Privilege)",
        "severity": "critical",
        "mitigation": "Enforce strict JWT scope validation and secondary authorization checks for all administrative endpoints.",
        "affected_components": [
          "Admin Dashboard",
          "Identity Service"
        ],
        "impact": "Full system compromise and data destruction.",
        "likelihood": "low"
      }
    ],
    "encryption": {
      "data_at_rest": {
        "method": "AES-256",
        "key_management": "AWS KMS",
        "description": "All database volumes, S3 buckets, and backups are encrypted using provider-managed keys with automatic rotation."
      },
      "data_in_transit": {
        "method": "TLS 1.3",
        "certificate_management": "AWS Certificate Manager (ACM)",
        "description": "Encryption is enforced for all external traffic and internal service-to-service communication via mTLS."
      },
      "key_management": {
        "strategy": "Cloud-Native KMS",
        "description": "Centralized key management using AWS KMS with strict IAM policies restricting key usage to specific service roles.",
        "rotation_policy": "Annual automatic rotation for master keys."
      },
      "envelope_encryption": true,
      "secrets_management": "AWS Secrets Manager"
    },
    "compliance": [
      {
        "standard": "GDPR",
        "requirements": [
          "Right to Erasure",
          "Data Portability",
          "Privacy by Design"
        ],
        "description": "Ensures European user data is handled according to strict privacy standards, including automated data deletion workflows.",
        "implementation_status": "in-progress"
      },
      {
        "standard": "PCI-DSS",
        "requirements": [
          "SAQ-A for Stripe Integration",
          "Encryption of Cardholder Data"
        ],
        "description": "EduPulse uses Stripe Elements to ensure no sensitive card data ever touches the platform's servers, maintaining a reduced compliance scope.",
        "implementation_status": "compliant"
      },
      {
        "standard": "SOC2",
        "requirements": [
          "Audit Logging",
          "Change Management",
          "Incident Response"
        ],
        "description": "Framework for managing data based on security, availability, processing integrity, confidentiality, and privacy.",
        "implementation_status": "planned"
      }
    ],
    "security_controls": [
      {
        "control": "Web Application Firewall (WAF)",
        "implementation": "Deployment of AWS WAF with managed rulesets to block common OWASP Top 10 attacks.",
        "category": "preventive",
        "priority": "high"
      },
      {
        "control": "CloudFront Signed URLs",
        "implementation": "Generating time-limited URLs for HLS stream manifests to prevent direct S3 access.",
        "category": "preventive",
        "priority": "critical"
      },
      {
        "control": "Database Row Level Security",
        "implementation": "PostgreSQL RLS policies to ensure learners can only query their own enrollment and progress records.",
        "category": "preventive",
        "priority": "high"
      },
      {
        "control": "VPC Security Groups",
        "implementation": "Strict ingress/egress rules allowing only necessary traffic between microservices and databases.",
        "category": "preventive",
        "priority": "high"
      }
    ],
    "vulnerability_management": {
      "patch_management": "Automated patching of EKS worker nodes using Amazon Linux 2 managed node groups and weekly container image rebuilds.",
      "scanning_frequency": "Continuous",
      "tools": [
        "Snyk",
        "Dependabot",
        "Amazon Inspector",
        "OWASP ZAP"
      ]
    },
    "security_monitoring": {
      "incident_response_plan": "Automated alerts via PagerDuty triggered by AWS GuardDuty findings and CloudWatch anomaly detection.",
      "log_retention": "365 days",
      "tools": [
        "AWS GuardDuty",
        "AWS CloudTrail",
        "ELK Stack (Security Logs)",
        "Datadog Security Monitoring"
      ]
    }
  }
}