{
  "artifact_path": "edustream-platform",
  "file_structure": {
    "name": "edustream-platform",
    "type": "directory",
    "children": [
      {
        "name": "apps",
        "type": "directory"
        },
        {
        "name": "web-client",
        "type": "directory"
        },
        {
        "name": "api-gateway",
        "type": "directory"
        },
        {
        "name": "course-service",
        "type": "directory"
        },
        {
        "name": "video-service",
        "type": "directory"
        },
        {
        "name": "ai-recommendation-service",
        "type": "directory"
        },
        {
        "name": "libs",
        "type": "directory"
        },
        {
        "name": "shared-types",
        "type": "directory"
        },
        {
        "name": "ui-components",
        "type": "directory"
        },
        {
        "name": "infra",
        "type": "directory"
        },
        {
        "name": "terraform",
        "type": "directory"
        },
        {
        "name": "k8s",
        "type": "directory"
        }
    ]
  },
  "implementation_plan": "# EduStream Technical Implementation Roadmap\n\n## Phase 1: Foundation & Identity (Weeks 1-3)\n- **Monorepo Orchestration**: Initialize Turborepo with Next.js (Frontend) and NestJS (Backend) workspaces.\n- **Identity Management**: Configure Auth0 tenants for Dev/Prod. Implement OIDC flow with custom claims for 'Instructor' and 'Learner' roles.\n- **Shared UI Library**: Build a Tailwind-based design system using Radix UI primitives, focusing on the 'Cinematic' dark theme.\n\n## Phase 2: Content Ingestion & Video Pipeline (Weeks 4-7)\n- **S3 Ingestion**: Setup secure multipart uploads with Pre-signed URLs for raw video assets.\n- **Transcoding Engine**: Implement AWS Elemental MediaConvert templates to generate HLS (m3u8) manifests with multiple bitrates (1080p, 720p, 480p).\n- **CDN Distribution**: Configure CloudFront with Signed Cookies to restrict video access to enrolled students only.\n\n## Phase 3: Core Learning Features (Weeks 8-11)\n- **Course Management**: Develop the NestJS Course Service using TypeORM and PostgreSQL. Implement JSONB for flexible quiz schemas.\n- **Progress Tracking**: Build a high-frequency heartbeat API to sync video playback position every 30s to Redis, with periodic persistence to Postgres.\n- **Search & Discovery**: Deploy Elasticsearch. Implement Change Data Capture (CDC) using Debezium to sync course metadata from Postgres to ES.\n\n## Phase 4: Commerce & Engagement (Weeks 12-14)\n- **Payment Integration**: Implement Stripe Checkout and Webhook handlers for automated enrollment and invoice generation.\n- **Social Learning**: Build a threaded discussion service using WebSockets for real-time interaction.\n- **Certificate Generation**: Create a serverless AWS Lambda function using Puppeteer to generate PDF certificates upon course completion.\n\n## Phase 5: AI Personalization & Optimization (Weeks 15-18)\n- **Recommendation Engine**: Develop a FastAPI service using Scikit-learn for collaborative filtering based on user watch history.\n- **Analytics Pipeline**: Stream user events to AWS Kinesis for real-time dashboard updates.\n- **Performance Tuning**: Implement ISR (Incremental Static Regeneration) for course landing pages to ensure <2s load times.",
  "dependencies": [
    "next@14.2.0",
    "@nestjs/core@10.3.0",
    "fastapi@0.110.0",
    "zustand@4.5.0",
    "@tanstack/react-query@5.28.0",
    "stripe@14.20.0",
    "typeorm@0.3.20",
    "pg@8.11.0",
    "elasticsearch@8.13.0",
    "auth0-js@9.24.0",
    "video.js@8.10.0",
    "tailwindcss@3.4.0",
    "framer-motion@11.0.0"
  ],
  "run_results": {
    "setup_commands": [
      "npm install",
      "npx turbo prune --scope=web-client",
      "docker-compose up -d postgres redis elasticsearch"
    ],
    "test_commands": [
      "npm run test",
      "npm run test:e2e"
    ],
    "dev_commands": [
      "npm run dev",
      "npx turbo run dev"
    ]
  },
  "summary": "A high-performance, microservices-driven e-learning platform featuring adaptive video streaming, AI-powered recommendations, and a cinematic user interface.",
  "description": "EduStream is engineered for scale and engagement. It utilizes a decoupled architecture where video processing is handled asynchronously via AWS MediaConvert, and course discovery is optimized through Elasticsearch. The frontend, built with Next.js, provides a 'Netflix-style' experience with deep-focus design tokens, while the backend services (NestJS and FastAPI) ensure robust business logic and intelligent content delivery.",
  "technical_decisions": [
    {
      "decision": "HLS (HTTP Live Streaming) with CloudFront",
      "rationale": "Ensures smooth playback across varying network conditions by providing adaptive bitrate streaming.",
      "alternatives": "Direct MP4 streaming (poor performance on slow connections)."
    },
    {
      "decision": "Zustand + TanStack Query",
      "rationale": "Zustand handles lightweight client-side UI state, while TanStack Query manages complex server-state synchronization and caching.",
      "alternatives": "Redux Toolkit (too boilerplate-heavy for this scope)."
    },
    {
      "decision": "PostgreSQL JSONB for Quizzes",
      "rationale": "Allows instructors to define diverse question types (MCQ, matching, code-input) without requiring frequent schema migrations.",
      "alternatives": "Strict relational tables (requires complex joins and migrations)."
    },
    {
      "decision": "Event-Driven Transcoding",
      "rationale": "Decouples the upload process from the UI, allowing the system to handle large video files without blocking the main API.",
      "alternatives": "Synchronous processing (leads to timeouts and poor UX)."
    }
  ],
  "environment_variables": [
    {
      "name": "DATABASE_URL",
      "description": "PostgreSQL connection string",
      "example": "postgresql://user:pass@localhost:5432/edustream"
    },
    {
      "name": "AUTH0_DOMAIN",
      "description": "Auth0 tenant domain for OIDC",
      "example": "edustream-prod.auth0.com"
    },
    {
      "name": "STRIPE_SECRET_KEY",
      "description": "Secret key for payment processing",
      "example": "sk_test_51..."
    },
    {
      "name": "AWS_MEDIA_CONVERT_ENDPOINT",
      "description": "Regional endpoint for AWS MediaConvert",
      "example": "https://abc123xyz.mediaconvert.us-east-1.amazonaws.com"
    }
  ],
  "technical_patterns": [
    "CQRS (Command Query Responsibility Segregation)",
    "BFF (Backend for Frontend)",
    "Repository Pattern",
    "Event Sourcing for Progress Tracking",
    "Micro-Frontends (via Module Federation)",
    "Clean Architecture"
  ],
  "state_management": {
    "tool": "Zustand & React Query",
    "strategy": "Slice-based client state for UI (modals, sidebar) and cached server-state for course data, progress, and user profiles with optimistic updates."
  }
}